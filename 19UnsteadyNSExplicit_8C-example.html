<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ITHACA-FV: 19UnsteadyNSExplicit.C</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ithaca-fv-small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="">ITHACA-FV</a>
   &#160;<span id="projectnumber"><a href="">2023.1</a></span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">19UnsteadyNSExplicit.C</div></div>
</div><!--header-->
<div class="contents">
<h1><a class="anchor" id="intro_UnsteadyNSExplicit"></a>
Introduction to tutorial 19</h1>
<p>In this tutorial we contruct a reduced order model for the classical lid driven cavity benchmark, which is a closed flow problem. The length of the two-dimensional square cavity is \(L\) = 1.0 m. A (64 \(\times\) 64) structured mesh with quadrilateral cells is constructed on the domain. A tangential uniform velocity \(U_{lid}\) = 1.0 m/s is prescribed at the top wall and non-slip conditions are applied to the other walls.</p>
<p>The following image depicts a sketch of the geometry of the two-dimensional lid driven cavity problem. </p><div class="image">
<img src="lidDrivenCavityGrid.png" alt=""/>
</div>
<p>The Reynolds number based on the velocity of the lid and the cavity characteristic length is 100 and the flow is considered laminar. The initial condition for the cell-centered velocity is a zero field. A full order simulation is performed for a constant time step of 0.005 s and for a total simulation time of 1.0 s in the offline stage.</p>
<p>In this tutorial, we employ explicit time integration methods at the full order and the reduced order level. We derive the reduced order model via the projection of the fully discrete system.</p>
<h1><a class="anchor" id="code19"></a>
A detailed look into the code</h1>
<p>In this section we explain the main steps necessary to construct the tutorial N°19</p>
<h2><a class="anchor" id="header"></a>
The necessary header files</h2>
<p>First of all let's have a look at the header files that need to be included and what they are responsible for.</p>
<p>The header files of ITHACA-FV necessary for this tutorial are: &lt;<a class="el" href="UnsteadyNSExplicit_8H.html" title="Header file of the UnsteadyNSExplicit class.">UnsteadyNSExplicit.H</a>&gt; for the full order unsteady NS problem discretized in time using Forward Euler, &lt;<a class="el" href="ITHACAPOD_8H.html" title="Header file of the ITHACAPOD class.">ITHACAPOD.H</a>&gt; for the POD decomposition, &lt;<a class="el" href="ReducedUnsteadyNSExplicit_8H.html" title="Header file of the ReducedUnsteadyNSExplicit class.">ReducedUnsteadyNSExplicit.H</a>&gt; for the construction of the reduced order problem, and finally &lt;<a class="el" href="ITHACAstream_8H.html" title="Header file of the ITHACAstream class, it contains the implementation of several methods for input ou...">ITHACAstream.H</a>&gt; for some ITHACA input-output operations.</p>
 <div class="fragment"><div class="line">    19UnsteadyNSExplicit.C</div>
<div class="line">\*---------------------------------------------------------------------------*/</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="UnsteadyNSExplicit_8H.html">UnsteadyNSExplicit.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ITHACAPOD_8H.html">ITHACAPOD.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ReducedUnsteadyNSExplicit_8H.html">ReducedUnsteadyNSExplicit.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ITHACAstream_8H.html">ITHACAstream.H</a>&quot;</span></div>
<div class="ttc" id="aITHACAPOD_8H_html"><div class="ttname"><a href="ITHACAPOD_8H.html">ITHACAPOD.H</a></div><div class="ttdoc">Header file of the ITHACAPOD class.</div></div>
<div class="ttc" id="aITHACAstream_8H_html"><div class="ttname"><a href="ITHACAstream_8H.html">ITHACAstream.H</a></div><div class="ttdoc">Header file of the ITHACAstream class, it contains the implementation of several methods for input ou...</div></div>
<div class="ttc" id="aReducedUnsteadyNSExplicit_8H_html"><div class="ttname"><a href="ReducedUnsteadyNSExplicit_8H.html">ReducedUnsteadyNSExplicit.H</a></div><div class="ttdoc">Header file of the ReducedUnsteadyNSExplicit class.</div></div>
<div class="ttc" id="aUnsteadyNSExplicit_8H_html"><div class="ttname"><a href="UnsteadyNSExplicit_8H.html">UnsteadyNSExplicit.H</a></div><div class="ttdoc">Header file of the UnsteadyNSExplicit class.</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="classtutorial19"></a>
Definition of the tutorial19 class</h2>
<p>We define the <a class="el" href="classtutorial19.html">tutorial19</a> class as a child of the <a class="el" href="classUnsteadyNSExplicit.html" title="Implementation of a parametrized full order  unsteady NS problem  and preparation of the the reduced ...">UnsteadyNSExplicit</a> class. The constructor is defined with members that are the fields need to be manipulated during the resolution of the full order problem using either a inconsistent flux method or a consistent flux method. Such fields are also initialized with the same initial conditions in the solver. </p><div class="fragment"><div class="line"><span class="keyword">class </span><a id="_a0" name="_a0"></a><a class="code hl_class" href="classtutorial19.html">tutorial19</a>: <span class="keyword">public</span> <a id="_a1" name="_a1"></a><a class="code hl_class" href="classUnsteadyNSExplicit.html">UnsteadyNSExplicit</a></div>
<div class="ttc" id="aclassUnsteadyNSExplicit_html"><div class="ttname"><a href="classUnsteadyNSExplicit.html">UnsteadyNSExplicit</a></div><div class="ttdoc">Implementation of a parametrized full order  unsteady NS problem  and preparation of the the reduced ...</div><div class="ttdef"><b>Definition</b> <a href="UnsteadyNSExplicit_8H_source.html#l00060">UnsteadyNSExplicit.H:61</a></div></div>
<div class="ttc" id="aclasstutorial19_html"><div class="ttname"><a href="classtutorial19.html">tutorial19</a></div><div class="ttdef"><b>Definition</b> <a href="19UnsteadyNSExplicit_8C_source.html#l00039">19UnsteadyNSExplicit.C:40</a></div></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        <span class="keyword">explicit</span> <a id="a2" name="a2"></a><a class="code hl_function" href="classtutorial19.html#ace7e8b1a20ed6bfaca77214786138efa">tutorial19</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">            :</div>
<div class="line">            <a id="a3" name="a3"></a><a class="code hl_function" href="classUnsteadyNSExplicit.html#a9ccc2bfb5c169889ebc437fe2801bc55">UnsteadyNSExplicit</a>(argc, argv),</div>
<div class="line">            <a id="a4" name="a4"></a><a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#ae4919c063fc0646445cdcafee89ebd60">U</a>(<a id="a5" name="a5"></a><a class="code hl_variable" href="classsteadyNS.html#ae8b03bc316b446d3ad311a80c5ada715">_U</a>()),</div>
<div class="line">            <a id="a6" name="a6"></a><a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#a334650304cdcdff41898bee9eaf2e3db">p</a>(<a id="a7" name="a7"></a><a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#ad87eff8426f119b54f0ae7841940306b">_p</a>()),</div>
<div class="line">            <a id="a8" name="a8"></a><a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#a1a97abcf6c141f539994c8a21c8daca7">phi</a>(<a id="a9" name="a9"></a><a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2UnsteadyNSExplicit_2createFields_8H.html#a40162fde1df058a2278666d0bc39a8e2">_phi</a>())</div>
<div class="line">        {}</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Fields To Perform</span></div>
<div class="line">        volVectorField&amp; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#ae4919c063fc0646445cdcafee89ebd60">U</a>;</div>
<div class="line">        volScalarField&amp; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#a334650304cdcdff41898bee9eaf2e3db">p</a>;</div>
<div class="line">        surfaceScalarField&amp; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#a1a97abcf6c141f539994c8a21c8daca7">phi</a>;</div>
<div class="ttc" id="aclassUnsteadyNSExplicit_html_a9ccc2bfb5c169889ebc437fe2801bc55"><div class="ttname"><a href="classUnsteadyNSExplicit.html#a9ccc2bfb5c169889ebc437fe2801bc55">UnsteadyNSExplicit::UnsteadyNSExplicit</a></div><div class="ttdeci">UnsteadyNSExplicit()</div><div class="ttdoc">Construct Null.</div><div class="ttdef"><b>Definition</b> <a href="UnsteadyNSExplicit_8C_source.html#l00040">UnsteadyNSExplicit.C:40</a></div></div>
<div class="ttc" id="aclasssteadyNS_html_ae8b03bc316b446d3ad311a80c5ada715"><div class="ttname"><a href="classsteadyNS.html#ae8b03bc316b446d3ad311a80c5ada715">steadyNS::_U</a></div><div class="ttdeci">autoPtr&lt; volVectorField &gt; _U</div><div class="ttdoc">Velocity field.</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00272">steadyNS.H:272</a></div></div>
<div class="ttc" id="aclasstutorial19_html_ace7e8b1a20ed6bfaca77214786138efa"><div class="ttname"><a href="classtutorial19.html#ace7e8b1a20ed6bfaca77214786138efa">tutorial19::tutorial19</a></div><div class="ttdeci">tutorial19(int argc, char *argv[])</div><div class="ttdef"><b>Definition</b> <a href="19UnsteadyNSExplicit_8C_source.html#l00042">19UnsteadyNSExplicit.C:42</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H_html_a1a97abcf6c141f539994c8a21c8daca7"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#a1a97abcf6c141f539994c8a21c8daca7">phi</a></div><div class="ttdeci">surfaceScalarField &amp; phi</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H_source.html#l00068">createFields.H:68</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H_html_ae4919c063fc0646445cdcafee89ebd60"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#ae4919c063fc0646445cdcafee89ebd60">U</a></div><div class="ttdeci">volVectorField &amp; U</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H_source.html#l00042">createFields.H:42</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H_html_a334650304cdcdff41898bee9eaf2e3db"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#a334650304cdcdff41898bee9eaf2e3db">p</a></div><div class="ttdeci">volScalarField &amp; p</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H_source.html#l00042">createFields.H:42</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H_html_ad87eff8426f119b54f0ae7841940306b"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#ad87eff8426f119b54f0ae7841940306b">_p</a></div><div class="ttdeci">_p</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H_source.html#l00037">createFields.H:37</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2UnsteadyNSExplicit_2createFields_8H_html_a40162fde1df058a2278666d0bc39a8e2"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2UnsteadyNSExplicit_2createFields_8H.html#a40162fde1df058a2278666d0bc39a8e2">_phi</a></div><div class="ttdeci">_phi</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2UnsteadyNSExplicit_2createFields_8H_source.html#l00110">createFields.H:110</a></div></div>
</div><!-- fragment --><p> Inside the <a class="el" href="classtutorial19.html">tutorial19</a> class we define the offlineSolve method according to the specific problem that needs to be solved. If the offline solve has been previously performed then the method just reads the existing velocity and pressure snapshots from the Offline directory. Otherwise it performs the offline solve. If the inconsistent flux method is selected, the snapshots of the fluxes (phi) are also read. The fluxMethod needs to be defined in the ITHACAdict file (inconsistent or consistent).</p>
<div class="fragment"><div class="line">        <span class="keywordtype">void</span> <a id="a10" name="a10"></a><a class="code hl_function" href="classtutorial19.html#a7f0dec0a130c27e8628fec1e1a21a922">offlineSolve</a>()</div>
<div class="ttc" id="aclasstutorial19_html_a7f0dec0a130c27e8628fec1e1a21a922"><div class="ttname"><a href="classtutorial19.html#a7f0dec0a130c27e8628fec1e1a21a922">tutorial19::offlineSolve</a></div><div class="ttdeci">void offlineSolve()</div><div class="ttdef"><b>Definition</b> <a href="19UnsteadyNSExplicit_8C_source.html#l00055">19UnsteadyNSExplicit.C:55</a></div></div>
<div class="line">        {</div>
<div class="line">            Vector&lt;double&gt; inl(1, 0, 0);</div>
<div class="line">            List&lt;scalar&gt; mu_now(1);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a id="a11" name="a11"></a><a class="code hl_variable" href="classreductionProblem.html#a752b5e2d6094c1ee18da4850443f1617">offline</a>)</div>
<div class="line">            {</div>
<div class="line">                <a id="a12" name="a12"></a><a class="code hl_function" href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a>(<a id="a13" name="a13"></a><a class="code hl_variable" href="classsteadyNS.html#a4efe3474afaa557ad5a211631115124f">Ufield</a>, <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#ae4919c063fc0646445cdcafee89ebd60">U</a>, <span class="stringliteral">&quot;./ITHACAoutput/Offline/&quot;</span>);</div>
<div class="line">                <a class="code hl_function" href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a>(<a id="a14" name="a14"></a><a class="code hl_variable" href="classsteadyNS.html#a30b8d9c76cc7f7f4d7dd6406cedba537">Pfield</a>, <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#a334650304cdcdff41898bee9eaf2e3db">p</a>, <span class="stringliteral">&quot;./ITHACAoutput/Offline/&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (<a id="a15" name="a15"></a><a class="code hl_variable" href="classsteadyNS.html#a80946aaf3718ca0c7d48156569ad20bd">fluxMethod</a> == <span class="stringliteral">&quot;consistent&quot;</span>)</div>
<div class="line">                {</div>
<div class="line">                    <a class="code hl_function" href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a>(<a id="a16" name="a16"></a><a class="code hl_variable" href="classsteadyNS.html#a6dd94576dd3d2a6007a4cf8712cc0ff4">Phifield</a>, <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#a1a97abcf6c141f539994c8a21c8daca7">phi</a>, <span class="stringliteral">&quot;./ITHACAoutput/Offline/&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="ttc" id="aclassreductionProblem_html_a752b5e2d6094c1ee18da4850443f1617"><div class="ttname"><a href="classreductionProblem.html#a752b5e2d6094c1ee18da4850443f1617">reductionProblem::offline</a></div><div class="ttdeci">bool offline</div><div class="ttdoc">Boolean variable, it is 1 if the Offline phase has already been computed, else 0.</div><div class="ttdef"><b>Definition</b> <a href="reductionProblem_8H_source.html#l00099">reductionProblem.H:99</a></div></div>
<div class="ttc" id="aclasssteadyNS_html_a30b8d9c76cc7f7f4d7dd6406cedba537"><div class="ttname"><a href="classsteadyNS.html#a30b8d9c76cc7f7f4d7dd6406cedba537">steadyNS::Pfield</a></div><div class="ttdeci">PtrList&lt; volScalarField &gt; Pfield</div><div class="ttdoc">List of pointers used to form the pressure snapshots matrix.</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00086">steadyNS.H:86</a></div></div>
<div class="ttc" id="aclasssteadyNS_html_a4efe3474afaa557ad5a211631115124f"><div class="ttname"><a href="classsteadyNS.html#a4efe3474afaa557ad5a211631115124f">steadyNS::Ufield</a></div><div class="ttdeci">PtrList&lt; volVectorField &gt; Ufield</div><div class="ttdoc">List of pointers used to form the velocity snapshots matrix.</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00089">steadyNS.H:89</a></div></div>
<div class="ttc" id="aclasssteadyNS_html_a6dd94576dd3d2a6007a4cf8712cc0ff4"><div class="ttname"><a href="classsteadyNS.html#a6dd94576dd3d2a6007a4cf8712cc0ff4">steadyNS::Phifield</a></div><div class="ttdeci">PtrList&lt; surfaceScalarField &gt; Phifield</div><div class="ttdoc">List of pointers used to form the flux snapshots matrix.</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00095">steadyNS.H:95</a></div></div>
<div class="ttc" id="aclasssteadyNS_html_a80946aaf3718ca0c7d48156569ad20bd"><div class="ttname"><a href="classsteadyNS.html#a80946aaf3718ca0c7d48156569ad20bd">steadyNS::fluxMethod</a></div><div class="ttdeci">word fluxMethod</div><div class="ttdoc">Flux Method.</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00329">steadyNS.H:329</a></div></div>
<div class="ttc" id="anamespaceITHACAstream_html_aa552d7dbbbd8f204bbf55b07836da550"><div class="ttname"><a href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a></div><div class="ttdeci">void read_fields(PtrList&lt; GeometricField&lt; Type, PatchField, GeoMesh &gt; &gt; &amp;Lfield, word Name, fileName casename, int first_snap, int n_snap)</div><div class="ttdoc">Function to read a list of fields from the name of the field and casename.</div><div class="ttdef"><b>Definition</b> <a href="ITHACAstream_8C_source.html#l00516">ITHACAstream.C:516</a></div></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">for</span> (label <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> = 0; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> &lt; <a id="a17" name="a17"></a><a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>.cols(); <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>++)</div>
<div class="line">                {</div>
<div class="line">                    mu_now[0] = <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>(0, <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>);</div>
<div class="line">                    <a id="a18" name="a18"></a><a class="code hl_function" href="classreductionProblem.html#aeab985e1958591a9de375c415c8d5e8d">truthSolve</a>(mu_now);</div>
<div class="line">                }</div>
<div class="ttc" id="aclassreductionProblem_html_acca797c9e7595c83d45d40c286b9a6ee"><div class="ttname"><a href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">reductionProblem::mu</a></div><div class="ttdeci">Eigen::MatrixXd mu</div><div class="ttdoc">Row matrix of parameters.</div><div class="ttdef"><b>Definition</b> <a href="reductionProblem_8H_source.html#l00089">reductionProblem.H:89</a></div></div>
<div class="ttc" id="aclassreductionProblem_html_aeab985e1958591a9de375c415c8d5e8d"><div class="ttname"><a href="classreductionProblem.html#aeab985e1958591a9de375c415c8d5e8d">reductionProblem::truthSolve</a></div><div class="ttdeci">void truthSolve()</div><div class="ttdoc">Perform a TruthSolve.</div><div class="ttdef"><b>Definition</b> <a href="reductionProblem_8C_source.html#l00097">reductionProblem.C:97</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H_html_ac23c63c7750d8829a77f4ebe1d961c48"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a></div><div class="ttdeci">label i</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H_source.html#l00046">pEqn.H:46</a></div></div>
<div class="line">            }</div>
<div class="line">        }</div>
</div><!-- fragment --> <h2><a class="anchor" id="main"></a>
Definition of the main function</h2>
<p>In this section we show the definition of the main function. First we construct the object "example" of type <a class="el" href="classtutorial19.html">tutorial19</a>:</p>
<div class="fragment"><div class="line">    <a class="code hl_class" href="classtutorial19.html">tutorial19</a> example(argc, argv);</div>
</div><!-- fragment --><p> Then we parse the ITHACAdict file to determine the number of modes to be written out and also the ones to be used for projection of the velocity and pressure. The discretize-then-project approach does not need any supremizer modes: </p><div class="fragment"><div class="line">    <a id="_a19" name="_a19"></a><a class="code hl_class" href="classITHACAparameters.html">ITHACAparameters</a>* <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a> = <a id="a20" name="a20"></a><a class="code hl_function" href="classITHACAparameters.html#adf4e7e15954b8779d57ed6478a19027f">ITHACAparameters::getInstance</a>(example._mesh(),</div>
<div class="ttc" id="aNLsolve_8H_html_a8fe34eb12dd4c1271bb9123ed6982124"><div class="ttname"><a href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a></div><div class="ttdeci">ITHACAparameters * para</div><div class="ttdef"><b>Definition</b> <a href="NLsolve_8H_source.html#l00040">NLsolve.H:40</a></div></div>
<div class="ttc" id="aclassITHACAparameters_html"><div class="ttname"><a href="classITHACAparameters.html">ITHACAparameters</a></div><div class="ttdoc">Class for the definition of some general parameters, the parameters must be defined from the file ITH...</div><div class="ttdef"><b>Definition</b> <a href="ITHACAparameters_8H_source.html#l00040">ITHACAparameters.H:41</a></div></div>
<div class="ttc" id="aclassITHACAparameters_html_adf4e7e15954b8779d57ed6478a19027f"><div class="ttname"><a href="classITHACAparameters.html#adf4e7e15954b8779d57ed6478a19027f">ITHACAparameters::getInstance</a></div><div class="ttdeci">static ITHACAparameters * getInstance()</div><div class="ttdoc">Gets an instance of ITHACAparameters, to be used if the instance is already existing.</div><div class="ttdef"><b>Definition</b> <a href="ITHACAparameters_8C_source.html#l00056">ITHACAparameters.C:56</a></div></div>
<div class="line">                             example._runTime());</div>
<div class="line">    <span class="keywordtype">int</span> NmodesUout = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesUout&quot;</span>, 15);</div>
<div class="line">    <span class="keywordtype">int</span> NmodesPout = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesPout&quot;</span>, 15);</div>
<div class="line">    <span class="keywordtype">int</span> NmodesSUPout = 0;</div>
<div class="line">    <span class="keywordtype">int</span> NmodesUproj = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesUproj&quot;</span>, 10);</div>
<div class="line">    <span class="keywordtype">int</span> NmodesPproj = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesPproj&quot;</span>, 10);</div>
<div class="line">    <span class="keywordtype">int</span> NmodesSUPproj = 0;</div>
</div><!-- fragment --><p> we note that a default value can be assigned in case the parser did not find the corresponding string in the ITHACAdict file.</p>
<p>In our implementation, the viscocity needs to be defined by specifying that Nparameters=1, Nsamples=1, and the parameter ranges from 0.01 to 0.01 equispaced, i.e.</p>
<div class="fragment"><div class="line">    example.Pnumber = 1;</div>
<div class="line"></div>
<div class="line">    example.Tnumber = 1;</div>
<div class="line">    example.setParameters();</div>
<div class="line">    <span class="comment">// Set the parameter ranges</span></div>
<div class="line">    example.mu_range(0, 0) = 0.01;</div>
<div class="line">    example.mu_range(0, 1) = 0.01;</div>
<div class="line">    <span class="comment">// Generate equispaced samples inside the parameter range</span></div>
<div class="line">    example.genEquiPar();</div>
</div><!-- fragment --><p> After that we set the inlet boundaries where we have the non-homogeneous BC. The lid is defined on Patch "0":</p>
<div class="fragment"><div class="line">    example.inletIndex.resize(1, 2);</div>
<div class="line">    example.inletIndex(0, 0) = 0;</div>
<div class="line">    example.inletIndex(0, 1) = 0;</div>
</div><!-- fragment --><p> And we set the parameters for the time integration, so as to simulate 1.0 seconds of simulation time, with a step size = 0.005 seconds, and the data are dumped every 0.005 seconds, i.e.</p>
<div class="fragment"><div class="line">    example.startTime = 0.0;</div>
<div class="line">    example.finalTime = 1.0;</div>
<div class="line">    example.timeStep = 0.005;</div>
<div class="line">    example.writeEvery = 0.005;</div>
</div><!-- fragment --><p> Now we are ready to perform the offline stage:</p>
<div class="fragment"><div class="line">    example.offlineSolve();</div>
</div><!-- fragment --><p> After that, the modes for velocity and pressure are obtained:</p>
<div class="fragment"><div class="line">    <a id="a21" name="a21"></a><a class="code hl_function" href="namespaceITHACAPOD.html#aa66f8357143947aa1c3359627eeb0ddd">ITHACAPOD::getModes</a>(example.Ufield, example.Umodes, example._U().name(),</div>
<div class="ttc" id="anamespaceITHACAPOD_html_aa66f8357143947aa1c3359627eeb0ddd"><div class="ttname"><a href="namespaceITHACAPOD.html#aa66f8357143947aa1c3359627eeb0ddd">ITHACAPOD::getModes</a></div><div class="ttdeci">void getModes(PtrList&lt; GeometricField&lt; Type, PatchField, GeoMesh &gt; &gt; &amp;snapshots, PtrList&lt; GeometricField&lt; Type, PatchField, GeoMesh &gt; &gt; &amp;modes, word fieldName, bool podex, bool supex, bool sup, label nmodes, bool correctBC)</div><div class="ttdoc">Computes the bases or reads them for a field.</div><div class="ttdef"><b>Definition</b> <a href="ITHACAPOD_8C_source.html#l00090">ITHACAPOD.C:90</a></div></div>
<div class="line">                        example.podex, 0, 0,</div>
<div class="line">                        NmodesUout);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAPOD.html#aa66f8357143947aa1c3359627eeb0ddd">ITHACAPOD::getModes</a>(example.Pfield, example.Pmodes, example._p().name(),</div>
<div class="line">                        example.podex, 0, 0,</div>
<div class="line">                        NmodesPout);</div>
</div><!-- fragment --><p> If the consistent flux method is used, the modes for the fluxes are also obtained:</p>
<div class="fragment"><div class="line">    <span class="keywordflow">if</span> (example.fluxMethod == <span class="stringliteral">&quot;consistent&quot;</span>)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_function" href="namespaceITHACAPOD.html#aa66f8357143947aa1c3359627eeb0ddd">ITHACAPOD::getModes</a>(example.Phifield, example.Phimodes,  example._phi().name(),</div>
<div class="line">                            example.podex, 0, 0,</div>
<div class="line">                            NmodesUout);</div>
<div class="line">    }</div>
</div><!-- fragment --><p> Next the projection onto the POD modes is performed with:</p>
<div class="fragment"><div class="line">    example.discretizeThenProject(<span class="stringliteral">&quot;./Matrices&quot;</span>, NmodesUproj, NmodesPproj,</div>
<div class="line">                                  NmodesSUPproj);</div>
</div><!-- fragment --><p> Now that we obtained all the necessary information from the POD decomposition and the reduced matrices, we are ready to construct the dynamical system for the reduced order model (ROM). We proceed by constructing the object "reduced" of type <a class="el" href="classReducedUnsteadyNSExplicit.html" title="Class where it is implemented a reduced problem for the  unsteady Navier-stokes  problem.">ReducedUnsteadyNSExplicit</a>:</p>
<div class="fragment"><div class="line">    <a id="_a22" name="_a22"></a><a class="code hl_class" href="classReducedUnsteadyNSExplicit.html">ReducedUnsteadyNSExplicit</a> reduced(example);</div>
<div class="ttc" id="aclassReducedUnsteadyNSExplicit_html"><div class="ttname"><a href="classReducedUnsteadyNSExplicit.html">ReducedUnsteadyNSExplicit</a></div><div class="ttdoc">Class where it is implemented a reduced problem for the  unsteady Navier-stokes  problem.</div><div class="ttdef"><b>Definition</b> <a href="ReducedUnsteadyNSExplicit_8H_source.html#l00056">ReducedUnsteadyNSExplicit.H:57</a></div></div>
</div><!-- fragment --><p> And then we can use the new constructed ROM to perform the online procedure, from which we can simulate the problem for a new value of the lid velocity. We are keeping the time stepping the same as for the full order simulation</p>
<div class="fragment"><div class="line">    reduced.nu = 0.01;</div>
<div class="line">    reduced.tstart = 0.0;</div>
<div class="line">    reduced.finalTime = 1.0;</div>
<div class="line">    reduced.dt = 0.005;</div>
<div class="line">    reduced.storeEvery = 0.005;</div>
<div class="line">    reduced.exportEvery = 0.005;</div>
</div><!-- fragment --><p> We have to specify a (new) value for the lid velocity: </p><div class="fragment"><div class="line">    Eigen::MatrixXd vel_now(1, 1);</div>
<div class="line">    vel_now(0, 0) = 1;</div>
</div><!-- fragment --><p> Hence we solve the reduced order model:</p>
<div class="fragment"><div class="line">    reduced.solveOnline(vel_now, 1);</div>
</div><!-- fragment --><p> Finally the ROM solution is reconstructed. In the case the solution should be exported and exported, put true instead of false in the function:</p>
<div class="fragment"><div class="line">    reduced.reconstruct(<span class="keyword">false</span>, <span class="stringliteral">&quot;./ITHACAoutput/Reconstruction/&quot;</span>);</div>
</div><!-- fragment --><h1><a class="anchor" id="plaincode"></a>
The plain program</h1>
<p>Here there's the plain code</p>
<div class="fragment"><div class="line"><span class="comment">/*---------------------------------------------------------------------------*\</span></div>
<div class="line"><span class="comment">     ██╗████████╗██╗  ██╗ █████╗  ██████╗ █████╗       ███████╗██╗   ██╗</span></div>
<div class="line"><span class="comment">     ██║╚══██╔══╝██║  ██║██╔══██╗██╔════╝██╔══██╗      ██╔════╝██║   ██║</span></div>
<div class="line"><span class="comment">     ██║   ██║   ███████║███████║██║     ███████║█████╗█████╗  ██║   ██║</span></div>
<div class="line"><span class="comment">     ██║   ██║   ██╔══██║██╔══██║██║     ██╔══██║╚════╝██╔══╝  ╚██╗ ██╔╝</span></div>
<div class="line"><span class="comment">     ██║   ██║   ██║  ██║██║  ██║╚██████╗██║  ██║      ██║      ╚████╔╝</span></div>
<div class="line"><span class="comment">     ╚═╝   ╚═╝   ╚═╝  ╚═╝╚═╝  ╚═╝ ╚═════╝╚═╝  ╚═╝      ╚═╝       ╚═══╝</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> * In real Time Highly Advanced Computational Applications for Finite Volumes</span></div>
<div class="line"><span class="comment"> * Copyright (C) 2021 by the ITHACA-FV authors</span></div>
<div class="line"><span class="comment">-------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">License</span></div>
<div class="line"><span class="comment">    This file is part of ITHACA-FV</span></div>
<div class="line"><span class="comment">    ITHACA-FV is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment">    it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><span class="comment">    the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment">    (at your option) any later version.</span></div>
<div class="line"><span class="comment">    ITHACA-FV is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div>
<div class="line"><span class="comment">    GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment">    You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment">    along with ITHACA-FV. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment">Description</span></div>
<div class="line"><span class="comment">    Example of an unsteady NS Reduction Problem with the Discretize-Then-</span></div>
<div class="line"><span class="comment">    Project approach for the lid driven cavity problem</span></div>
<div class="line"><span class="comment">SourceFiles</span></div>
<div class="line"><span class="comment">    19UnsteadyNSExplicit.C</span></div>
<div class="line"><span class="comment">\*---------------------------------------------------------------------------*/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="UnsteadyNSExplicit_8H.html">UnsteadyNSExplicit.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ITHACAPOD_8H.html">ITHACAPOD.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ReducedUnsteadyNSExplicit_8H.html">ReducedUnsteadyNSExplicit.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ITHACAstream_8H.html">ITHACAstream.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><span class="preprocessor">#include&lt;math.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include&lt;iomanip&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classtutorial19.html">tutorial19</a>: <span class="keyword">public</span> <a class="code hl_class" href="classUnsteadyNSExplicit.html">UnsteadyNSExplicit</a></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        <span class="keyword">explicit</span> <a class="code hl_function" href="classtutorial19.html#ace7e8b1a20ed6bfaca77214786138efa">tutorial19</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">            :</div>
<div class="line">            <a class="code hl_function" href="classUnsteadyNSExplicit.html#a9ccc2bfb5c169889ebc437fe2801bc55">UnsteadyNSExplicit</a>(argc, argv),</div>
<div class="line">            <a id="a23" name="a23"></a><a class="code hl_variable" href="classtutorial19.html#a7a507fc1fe10346fe00bf4a6abac9ec3">U</a>(<a class="code hl_variable" href="classsteadyNS.html#ae8b03bc316b446d3ad311a80c5ada715">_U</a>()),</div>
<div class="line">            <a id="a24" name="a24"></a><a class="code hl_variable" href="classtutorial19.html#a52c236f7294f6f1ebc169158b78074ba">p</a>(<a id="a25" name="a25"></a><a class="code hl_variable" href="classsteadyNS.html#afe342c9980231332bb8c22bbceb32254">_p</a>()),</div>
<div class="line">            <a id="a26" name="a26"></a><a class="code hl_variable" href="classtutorial19.html#aff816a7b2a38ddcf7e23b263ff4acd6d">phi</a>(<a id="a27" name="a27"></a><a class="code hl_variable" href="classsteadyNS.html#a27dd336cf3b9757ba406b3d3926ac299">_phi</a>())</div>
<div class="line">        {}</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Fields To Perform</span></div>
<div class="line">        volVectorField&amp; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#ae4919c063fc0646445cdcafee89ebd60">U</a>;</div>
<div class="line">        volScalarField&amp; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#a334650304cdcdff41898bee9eaf2e3db">p</a>;</div>
<div class="line">        surfaceScalarField&amp; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#a1a97abcf6c141f539994c8a21c8daca7">phi</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">void</span> <a class="code hl_function" href="classtutorial19.html#a7f0dec0a130c27e8628fec1e1a21a922">offlineSolve</a>()</div>
<div class="line">        {</div>
<div class="line">            Vector&lt;double&gt; inl(1, 0, 0);</div>
<div class="line">            List&lt;scalar&gt; mu_now(1);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classreductionProblem.html#a752b5e2d6094c1ee18da4850443f1617">offline</a>)</div>
<div class="line">            {</div>
<div class="line">                <a class="code hl_function" href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a>(<a class="code hl_variable" href="classsteadyNS.html#a4efe3474afaa557ad5a211631115124f">Ufield</a>, <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#ae4919c063fc0646445cdcafee89ebd60">U</a>, <span class="stringliteral">&quot;./ITHACAoutput/Offline/&quot;</span>);</div>
<div class="line">                <a class="code hl_function" href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a>(<a class="code hl_variable" href="classsteadyNS.html#a30b8d9c76cc7f7f4d7dd6406cedba537">Pfield</a>, <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#a334650304cdcdff41898bee9eaf2e3db">p</a>, <span class="stringliteral">&quot;./ITHACAoutput/Offline/&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classsteadyNS.html#a80946aaf3718ca0c7d48156569ad20bd">fluxMethod</a> == <span class="stringliteral">&quot;consistent&quot;</span>)</div>
<div class="line">                {</div>
<div class="line">                    <a class="code hl_function" href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a>(<a class="code hl_variable" href="classsteadyNS.html#a6dd94576dd3d2a6007a4cf8712cc0ff4">Phifield</a>, <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#a1a97abcf6c141f539994c8a21c8daca7">phi</a>, <span class="stringliteral">&quot;./ITHACAoutput/Offline/&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                <span class="keywordflow">for</span> (label <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> = 0; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> &lt; <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>.cols(); <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>++)</div>
<div class="line">                {</div>
<div class="line">                    mu_now[0] = <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>(0, <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>);</div>
<div class="line">                    <a class="code hl_function" href="classreductionProblem.html#aeab985e1958591a9de375c415c8d5e8d">truthSolve</a>(mu_now);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*---------------------------------------------------------------------------*\</span></div>
<div class="line"><span class="comment">                               Starting the MAIN</span></div>
<div class="line"><span class="comment">\*---------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="keywordtype">int</span> <a id="a28" name="a28"></a><a class="code hl_function" href="extract__time__evolution_8C.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Construct the tutorial19 object</span></div>
<div class="line">    <a class="code hl_class" href="classtutorial19.html">tutorial19</a> example(argc, argv);</div>
<div class="line">    <span class="comment">// Read parameters from ITHACAdict file</span></div>
<div class="line">    <a class="code hl_class" href="classITHACAparameters.html">ITHACAparameters</a>* <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a> = <a class="code hl_function" href="classITHACAparameters.html#adf4e7e15954b8779d57ed6478a19027f">ITHACAparameters::getInstance</a>(example._mesh(),</div>
<div class="line">                             example._runTime());</div>
<div class="line">    <span class="keywordtype">int</span> NmodesUout = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesUout&quot;</span>, 15);</div>
<div class="line">    <span class="keywordtype">int</span> NmodesPout = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesPout&quot;</span>, 15);</div>
<div class="line">    <span class="keywordtype">int</span> NmodesSUPout = 0;</div>
<div class="line">    <span class="keywordtype">int</span> NmodesUproj = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesUproj&quot;</span>, 10);</div>
<div class="line">    <span class="keywordtype">int</span> NmodesPproj = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesPproj&quot;</span>, 10);</div>
<div class="line">    <span class="keywordtype">int</span> NmodesSUPproj = 0;</div>
<div class="line">    example.Pnumber = 1;</div>
<div class="line">    example.Tnumber = 1;</div>
<div class="line">    example.setParameters();</div>
<div class="line">    <span class="comment">// Set the parameter ranges</span></div>
<div class="line">    example.mu_range(0, 0) = 0.01;</div>
<div class="line">    example.mu_range(0, 1) = 0.01;</div>
<div class="line">    <span class="comment">// Generate equispaced samples inside the parameter range</span></div>
<div class="line">    example.genEquiPar();</div>
<div class="line">    <span class="comment">// Set the inlet boundaries where we have non homogeneous boundary conditions</span></div>
<div class="line">    example.inletIndex.resize(1, 2);</div>
<div class="line">    example.inletIndex(0, 0) = 0;</div>
<div class="line">    example.inletIndex(0, 1) = 0;</div>
<div class="line">    <span class="comment">// Time parameters</span></div>
<div class="line">    example.startTime = 0.0;</div>
<div class="line">    example.finalTime = 1.0;</div>
<div class="line">    example.timeStep = 0.005;</div>
<div class="line">    example.writeEvery = 0.005;</div>
<div class="line">    <span class="comment">// Perform The Offline Solve;</span></div>
<div class="line">    example.offlineSolve();</div>
<div class="line">    <span class="comment">// Perform a POD decomposition for velocity and pressure</span></div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAPOD.html#aa66f8357143947aa1c3359627eeb0ddd">ITHACAPOD::getModes</a>(example.Ufield, example.Umodes, example._U().name(),</div>
<div class="line">                        example.podex, 0, 0,</div>
<div class="line">                        NmodesUout);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAPOD.html#aa66f8357143947aa1c3359627eeb0ddd">ITHACAPOD::getModes</a>(example.Pfield, example.Pmodes, example._p().name(),</div>
<div class="line">                        example.podex, 0, 0,</div>
<div class="line">                        NmodesPout);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (example.fluxMethod == <span class="stringliteral">&quot;consistent&quot;</span>)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_function" href="namespaceITHACAPOD.html#aa66f8357143947aa1c3359627eeb0ddd">ITHACAPOD::getModes</a>(example.Phifield, example.Phimodes,  example._phi().name(),</div>
<div class="line">                            example.podex, 0, 0,</div>
<div class="line">                            NmodesUout);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Galerkin Projection</span></div>
<div class="line">    example.discretizeThenProject(<span class="stringliteral">&quot;./Matrices&quot;</span>, NmodesUproj, NmodesPproj,</div>
<div class="line">                                  NmodesSUPproj);</div>
<div class="line">    <a class="code hl_class" href="classReducedUnsteadyNSExplicit.html">ReducedUnsteadyNSExplicit</a> reduced(example);</div>
<div class="line">    <span class="comment">// Set values of the reduced order model</span></div>
<div class="line">    reduced.nu = 0.01;</div>
<div class="line">    reduced.tstart = 0.0;</div>
<div class="line">    reduced.finalTime = 1.0;</div>
<div class="line">    reduced.dt = 0.005;</div>
<div class="line">    reduced.storeEvery = 0.005;</div>
<div class="line">    reduced.exportEvery = 0.005;</div>
<div class="line">    <span class="comment">// Set the online velocity</span></div>
<div class="line">    Eigen::MatrixXd vel_now(1, 1);</div>
<div class="line">    vel_now(0, 0) = 1;</div>
<div class="line">    reduced.solveOnline(vel_now, 1);</div>
<div class="line">    <span class="comment">// Reconstruct the solution and export it</span></div>
<div class="line">    reduced.reconstruct(<span class="keyword">false</span>, <span class="stringliteral">&quot;./ITHACAoutput/Reconstruction/&quot;</span>);</div>
<div class="line">    exit(0);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="ttc" id="aclasssteadyNS_html_a27dd336cf3b9757ba406b3d3926ac299"><div class="ttname"><a href="classsteadyNS.html#a27dd336cf3b9757ba406b3d3926ac299">steadyNS::_phi</a></div><div class="ttdeci">autoPtr&lt; surfaceScalarField &gt; _phi</div><div class="ttdoc">Flux.</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00302">steadyNS.H:302</a></div></div>
<div class="ttc" id="aclasssteadyNS_html_afe342c9980231332bb8c22bbceb32254"><div class="ttname"><a href="classsteadyNS.html#afe342c9980231332bb8c22bbceb32254">steadyNS::_p</a></div><div class="ttdeci">autoPtr&lt; volScalarField &gt; _p</div><div class="ttdoc">Pressure field.</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00269">steadyNS.H:269</a></div></div>
<div class="ttc" id="aclasstutorial19_html_a52c236f7294f6f1ebc169158b78074ba"><div class="ttname"><a href="classtutorial19.html#a52c236f7294f6f1ebc169158b78074ba">tutorial19::p</a></div><div class="ttdeci">volScalarField &amp; p</div><div class="ttdef"><b>Definition</b> <a href="19UnsteadyNSExplicit_8C_source.html#l00052">19UnsteadyNSExplicit.C:52</a></div></div>
<div class="ttc" id="aclasstutorial19_html_a7a507fc1fe10346fe00bf4a6abac9ec3"><div class="ttname"><a href="classtutorial19.html#a7a507fc1fe10346fe00bf4a6abac9ec3">tutorial19::U</a></div><div class="ttdeci">volVectorField &amp; U</div><div class="ttdef"><b>Definition</b> <a href="19UnsteadyNSExplicit_8C_source.html#l00051">19UnsteadyNSExplicit.C:51</a></div></div>
<div class="ttc" id="aclasstutorial19_html_aff816a7b2a38ddcf7e23b263ff4acd6d"><div class="ttname"><a href="classtutorial19.html#aff816a7b2a38ddcf7e23b263ff4acd6d">tutorial19::phi</a></div><div class="ttdeci">surfaceScalarField &amp; phi</div><div class="ttdef"><b>Definition</b> <a href="19UnsteadyNSExplicit_8C_source.html#l00053">19UnsteadyNSExplicit.C:53</a></div></div>
<div class="ttc" id="aextract__time__evolution_8C_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="extract__time__evolution_8C.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition</b> <a href="extract__time__evolution_8C_source.html#l00021">extract_time_evolution.C:21</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.13.2
</small></address>
</body>
</html>
