<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ITHACA-FV: 06POD_RBF.C</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ithaca-fv-small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="">ITHACA-FV</a>
   &#160;<span id="projectnumber"><a href="">2023.1</a></span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">06POD_RBF.C</div></div>
</div><!--header-->
<div class="contents">
<h1><a class="anchor" id="intro_podRBF"></a>
Introduction to turorial 6</h1>
<p>The problems consists of steady Navier-Stokes problem with a parameterized velocity at the inlet. The physical problem is the pitz-daily depicted in the following image </p><div class="image">
<img src="pitzdaily.png" alt=""/>
</div>
<p> The velocity at the inlet is parameterized in both x and y directions. In other words, the parameters in this setting are the magnitude of the velocity at the inlet and the inclination of the velocity with respect to the inlet. </p>
<h1><a class="anchor" id="CODE"></a>
A detailed look into the code</h1>
<p>This section explains the main steps necessary to construct the tutorial NÂ°6.</p>
<h2><a class="anchor" id="header"></a>
The necessary header files</h2>
<p>First of all let's have a look into the header files which have to be included, indicating what they are responsible for:</p>
<p> The OpenFOAM header files: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;fvCFD.H&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;fvOptions.H&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;IOmanip.H&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;simpleControl.H&quot;</span></div>
</div><!-- fragment --><p> ITHACA-FV header files, &lt;<a class="el" href="ITHACAstream_8H.html" title="Header file of the ITHACAstream class, it contains the implementation of several methods for input ou...">ITHACAstream.H</a>&gt; is responsible for reading and exporting the fields and other sorts of data. &lt;<a class="el" href="ITHACAutilities_8H.html" title="Header file of the ITHACAutilities namespace.">ITHACAutilities.H</a>&gt; has the utilities which compute the mass matrices, fields norms, fields error,...etc. &lt;<a class="el" href="Foam2Eigen_8H.html" title="Header file of the Foam2Eigen class.">Foam2Eigen.H</a>&gt; is for converting fields and other data from OpenFOAM to <a class="el" href="namespaceEigen.html">Eigen</a> format. &lt;<a class="el" href="ITHACAPOD_8H.html" title="Header file of the ITHACAPOD class.">ITHACAPOD.H</a>&gt; is for the computation of the POD modes. </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ITHACAutilities_8H.html">ITHACAutilities.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="Foam2Eigen_8H.html">Foam2Eigen.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ITHACAstream_8H.html">ITHACAstream.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ITHACAPOD_8H.html">ITHACAPOD.H</a>&quot;</span></div>
<div class="ttc" id="aFoam2Eigen_8H_html"><div class="ttname"><a href="Foam2Eigen_8H.html">Foam2Eigen.H</a></div><div class="ttdoc">Header file of the Foam2Eigen class.</div></div>
<div class="ttc" id="aITHACAPOD_8H_html"><div class="ttname"><a href="ITHACAPOD_8H.html">ITHACAPOD.H</a></div><div class="ttdoc">Header file of the ITHACAPOD class.</div></div>
<div class="ttc" id="aITHACAstream_8H_html"><div class="ttname"><a href="ITHACAstream_8H.html">ITHACAstream.H</a></div><div class="ttdoc">Header file of the ITHACAstream class, it contains the implementation of several methods for input ou...</div></div>
<div class="ttc" id="aITHACAutilities_8H_html"><div class="ttname"><a href="ITHACAutilities_8H.html">ITHACAutilities.H</a></div><div class="ttdoc">Header file of the ITHACAutilities namespace.</div></div>
</div><!-- fragment --><p>The <a class="el" href="namespaceEigen.html">Eigen</a> library for matrix manipulation and linear and non-linear algebra operations: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;Eigen/Dense&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Eigen/SVD&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Eigen/SparseLU&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="EigenFunctions_8H.html">EigenFunctions.H</a>&quot;</span></div>
<div class="ttc" id="aEigenFunctions_8H_html"><div class="ttname"><a href="EigenFunctions_8H.html">EigenFunctions.H</a></div><div class="ttdoc">Header file of the EigenFunctions class.</div></div>
</div><!-- fragment --><p>chrono to compute the speedup </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
</div><!-- fragment --><p>The header files of ITHACA-FV necessary for this tutorial are: &lt;<a class="el" href="reductionProblem_8H.html" title="Header file of the reductionProblem class.">reductionProblem.H</a>&gt; A general class for the implementation of a full order parameterized problem. &lt;<a class="el" href="steadyNS_8H.html" title="Header file of the steadyNS class.">steadyNS.H</a>&gt; is for the full order steady NS problem , &lt;<a class="el" href="SteadyNSTurb_8H.html" title="Header file of the SteadyNSTurb class.">SteadyNSTurb.H</a>&gt; is the child of &lt;<a class="el" href="steadyNS_8H.html" title="Header file of the steadyNS class.">steadyNS.H</a>&gt; and it is the class for the full order steady NS turbulent problem. Finally &lt;reducedSteadyNS.H&gt; and &lt;<a class="el" href="ReducedSteadyNSTurb_8H.html" title="Header file of the ReducedSteadyNSTurb class.">ReducedSteadyNSTurb.H</a>&gt; are for the construction of the reduced order problems </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="reductionProblem_8H.html">reductionProblem.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="steadyNS_8H.html">steadyNS.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SteadyNSTurb_8H.html">SteadyNSTurb.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ReducedSteadyNS_8H.html">ReducedSteadyNS.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ReducedSteadyNSTurb_8H.html">ReducedSteadyNSTurb.H</a>&quot;</span></div>
<div class="ttc" id="aReducedSteadyNSTurb_8H_html"><div class="ttname"><a href="ReducedSteadyNSTurb_8H.html">ReducedSteadyNSTurb.H</a></div><div class="ttdoc">Header file of the ReducedSteadyNSTurb class.</div></div>
<div class="ttc" id="aReducedSteadyNS_8H_html"><div class="ttname"><a href="ReducedSteadyNS_8H.html">ReducedSteadyNS.H</a></div><div class="ttdoc">Header file of the reducedSteadyNS class.</div></div>
<div class="ttc" id="aSteadyNSTurb_8H_html"><div class="ttname"><a href="SteadyNSTurb_8H.html">SteadyNSTurb.H</a></div><div class="ttdoc">Header file of the SteadyNSTurb class.</div></div>
<div class="ttc" id="areductionProblem_8H_html"><div class="ttname"><a href="reductionProblem_8H.html">reductionProblem.H</a></div><div class="ttdoc">Header file of the reductionProblem class.</div></div>
<div class="ttc" id="asteadyNS_8H_html"><div class="ttname"><a href="steadyNS_8H.html">steadyNS.H</a></div><div class="ttdoc">Header file of the steadyNS class.</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="classtutorial06"></a>
Definition of the tutorial06 class</h2>
<p>We define the <a class="el" href="classtutorial06.html" title="Class where the tutorial number 6 is implemented.">tutorial06</a> class as a child of the <a class="el" href="classSteadyNSTurb.html" title="Implementation of a parametrized full order  steady turbulent Navier Stokes problem  and preparation ...">SteadyNSTurb</a> class. The constructor is defined with members that are the fields required to be manipulated during the resolution of the full order problem using simpleFoam. Such fields are also initialized with the same initial conditions in the solver. </p><div class="fragment"><div class="line"><span class="keyword">class </span><a id="_a0" name="_a0"></a><a class="code hl_class" href="classtutorial06.html">tutorial06</a> : <span class="keyword">public</span> <a id="_a1" name="_a1"></a><a class="code hl_class" href="classSteadyNSTurb.html">SteadyNSTurb</a></div>
<div class="ttc" id="aclassSteadyNSTurb_html"><div class="ttname"><a href="classSteadyNSTurb.html">SteadyNSTurb</a></div><div class="ttdoc">Implementation of a parametrized full order  steady turbulent Navier Stokes problem  and preparation ...</div><div class="ttdef"><b>Definition</b> <a href="SteadyNSTurb_8H_source.html#l00065">SteadyNSTurb.H:66</a></div></div>
<div class="ttc" id="aclasstutorial06_html"><div class="ttname"><a href="classtutorial06.html">tutorial06</a></div><div class="ttdoc">Class where the tutorial number 6 is implemented.</div><div class="ttdef"><b>Definition</b> <a href="06POD__RBF_8C_source.html#l00055">06POD_RBF.C:56</a></div></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        <span class="keyword">explicit</span> <a id="a2" name="a2"></a><a class="code hl_function" href="classtutorial06.html#a7a63444769e473558ba02b6135d38858">tutorial06</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">            :</div>
<div class="line">            <a id="a3" name="a3"></a><a class="code hl_function" href="classSteadyNSTurb.html#acf59090fea98d6e00a1ea8156ae9469e">SteadyNSTurb</a>(argc, argv),</div>
<div class="line">            <a id="a4" name="a4"></a><a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#ae4919c063fc0646445cdcafee89ebd60">U</a>(<a id="a5" name="a5"></a><a class="code hl_variable" href="classsteadyNS.html#ae8b03bc316b446d3ad311a80c5ada715">_U</a>()),</div>
<div class="line">            <a id="a6" name="a6"></a><a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#a334650304cdcdff41898bee9eaf2e3db">p</a>(<a id="a7" name="a7"></a><a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#ad87eff8426f119b54f0ae7841940306b">_p</a>()),</div>
<div class="line">            <a id="a8" name="a8"></a><a class="code hl_variable" href="NLsolve_8H.html#accb6562fe0a89c5cdf51fd48160731dd">nut</a>(<a id="a9" name="a9"></a><a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2SteadyNSTurb_2createFields_8H.html#a6474dce93ee9fd1d383863a810d832e3">_nut</a>())</div>
<div class="line">        {}</div>
<div class="ttc" id="aNLsolve_8H_html_accb6562fe0a89c5cdf51fd48160731dd"><div class="ttname"><a href="NLsolve_8H.html#accb6562fe0a89c5cdf51fd48160731dd">nut</a></div><div class="ttdeci">auto nut</div><div class="ttdef"><b>Definition</b> <a href="NLsolve_8H_source.html#l00195">NLsolve.H:195</a></div></div>
<div class="ttc" id="aclassSteadyNSTurb_html_acf59090fea98d6e00a1ea8156ae9469e"><div class="ttname"><a href="classSteadyNSTurb.html#acf59090fea98d6e00a1ea8156ae9469e">SteadyNSTurb::SteadyNSTurb</a></div><div class="ttdeci">SteadyNSTurb()</div><div class="ttdef"><b>Definition</b> <a href="SteadyNSTurb_8C_source.html#l00038">SteadyNSTurb.C:38</a></div></div>
<div class="ttc" id="aclasssteadyNS_html_ae8b03bc316b446d3ad311a80c5ada715"><div class="ttname"><a href="classsteadyNS.html#ae8b03bc316b446d3ad311a80c5ada715">steadyNS::_U</a></div><div class="ttdeci">autoPtr&lt; volVectorField &gt; _U</div><div class="ttdoc">Velocity field.</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00272">steadyNS.H:272</a></div></div>
<div class="ttc" id="aclasstutorial06_html_a7a63444769e473558ba02b6135d38858"><div class="ttname"><a href="classtutorial06.html#a7a63444769e473558ba02b6135d38858">tutorial06::tutorial06</a></div><div class="ttdeci">tutorial06(int argc, char *argv[])</div><div class="ttdef"><b>Definition</b> <a href="06POD__RBF_8C_source.html#l00058">06POD_RBF.C:58</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H_html_ae4919c063fc0646445cdcafee89ebd60"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#ae4919c063fc0646445cdcafee89ebd60">U</a></div><div class="ttdeci">volVectorField &amp; U</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H_source.html#l00042">createFields.H:42</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H_html_a334650304cdcdff41898bee9eaf2e3db"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#a334650304cdcdff41898bee9eaf2e3db">p</a></div><div class="ttdeci">volScalarField &amp; p</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H_source.html#l00042">createFields.H:42</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H_html_ad87eff8426f119b54f0ae7841940306b"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#ad87eff8426f119b54f0ae7841940306b">_p</a></div><div class="ttdeci">_p</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H_source.html#l00037">createFields.H:37</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2SteadyNSTurb_2createFields_8H_html_a6474dce93ee9fd1d383863a810d832e3"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2SteadyNSTurb_2createFields_8H.html#a6474dce93ee9fd1d383863a810d832e3">_nut</a></div><div class="ttdeci">_nut</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2SteadyNSTurb_2createFields_8H_source.html#l00061">createFields.H:61</a></div></div>
</div><!-- fragment --><p> Inside the <a class="el" href="classtutorial06.html" title="Class where the tutorial number 6 is implemented.">tutorial06</a> class we define the offlineSolve method according to the specific parameterized problem that needs to be solved. If the offline solve has been previously performed then the method just reads the existing snapshots from the Offline directory, and if the offline solve has been started but not completed then it continues the offline stage from the last snapshot computed. If the procedure has not started at all, the method loops over all the parameters samples, changes the inlet velocity components at the inlet with the iterable parameter sample for both components of the velocity then it performs the offline solve. </p><div class="fragment"><div class="line">        <span class="keywordtype">void</span> <a id="a10" name="a10"></a><a class="code hl_function" href="classtutorial06.html#aecc518758bcaae3b0a514db77e6263cf">offlineSolve</a>()</div>
<div class="ttc" id="aclasstutorial06_html_aecc518758bcaae3b0a514db77e6263cf"><div class="ttname"><a href="classtutorial06.html#aecc518758bcaae3b0a514db77e6263cf">tutorial06::offlineSolve</a></div><div class="ttdeci">void offlineSolve()</div><div class="ttdoc">Perform an Offline solve.</div><div class="ttdef"><b>Definition</b> <a href="06POD__RBF_8C_source.html#l00072">06POD_RBF.C:72</a></div></div>
<div class="line">        {</div>
<div class="line">            Vector&lt;double&gt; inl(0, 0, 0);</div>
<div class="line">            List&lt;scalar&gt; mu_now(2);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// if the offline solution is already performed read the fields</span></div>
<div class="line">            <span class="keywordflow">if</span> (<a id="a11" name="a11"></a><a class="code hl_variable" href="classreductionProblem.html#a752b5e2d6094c1ee18da4850443f1617">offline</a>)</div>
<div class="line">            {</div>
<div class="line">                <a id="a12" name="a12"></a><a class="code hl_function" href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a>(<a id="a13" name="a13"></a><a class="code hl_variable" href="classsteadyNS.html#a4efe3474afaa557ad5a211631115124f">Ufield</a>, <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#ae4919c063fc0646445cdcafee89ebd60">U</a>, <span class="stringliteral">&quot;./ITHACAoutput/Offline/&quot;</span>);</div>
<div class="line">                <a class="code hl_function" href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a>(<a id="a14" name="a14"></a><a class="code hl_variable" href="classsteadyNS.html#a30b8d9c76cc7f7f4d7dd6406cedba537">Pfield</a>, <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#a334650304cdcdff41898bee9eaf2e3db">p</a>, <span class="stringliteral">&quot;./ITHACAoutput/Offline/&quot;</span>);</div>
<div class="line">                <a class="code hl_function" href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a>(<a id="a15" name="a15"></a><a class="code hl_variable" href="classSteadyNSTurb.html#a4bda4f74c0cf2abe5f4096c663b7a8a8">nutFields</a>, <a class="code hl_variable" href="NLsolve_8H.html#accb6562fe0a89c5cdf51fd48160731dd">nut</a>, <span class="stringliteral">&quot;./ITHACAoutput/Offline/&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// if the offline stage is not completed then resume it</span></div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classsteadyNS.html#a4efe3474afaa557ad5a211631115124f">Ufield</a>.size() &lt; <a id="a16" name="a16"></a><a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>.rows())</div>
<div class="line">                {</div>
<div class="line">                    Vector&lt;double&gt; <a id="a17" name="a17"></a><a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>(0, 0, 0);</div>
<div class="line">                    label BCind = 0;</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">for</span> (label <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> = <a class="code hl_variable" href="classsteadyNS.html#a4efe3474afaa557ad5a211631115124f">Ufield</a>.size(); <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> &lt; <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>.rows(); <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>++)</div>
<div class="line">                    {</div>
<div class="line">                        <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>[0] = <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>, 0);</div>
<div class="line">                        <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>[1] = <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>, 1);</div>
<div class="line">                        <a id="a18" name="a18"></a><a class="code hl_function" href="classreductionProblem.html#a58ac7e74dd757c1e96bffead2b49ec80">assignBC</a>(<a class="code hl_variable" href="classsteadyNS.html#ae8b03bc316b446d3ad311a80c5ada715">_U</a>(), BCind, <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>);</div>
<div class="line">                        <a id="a19" name="a19"></a><a class="code hl_variable" href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">counter</a> = <a class="code hl_variable" href="classsteadyNS.html#a4efe3474afaa557ad5a211631115124f">Ufield</a>.size() + 1;</div>
<div class="line">                        <a id="a20" name="a20"></a><a class="code hl_function" href="classreductionProblem.html#aeab985e1958591a9de375c415c8d5e8d">truthSolve</a>(<span class="stringliteral">&quot;./ITHACAoutput/Offline/&quot;</span>);</div>
<div class="line">                    }</div>
<div class="ttc" id="aclassSteadyNSTurb_html_a4bda4f74c0cf2abe5f4096c663b7a8a8"><div class="ttname"><a href="classSteadyNSTurb.html#a4bda4f74c0cf2abe5f4096c663b7a8a8">SteadyNSTurb::nutFields</a></div><div class="ttdeci">PtrList&lt; volScalarField &gt; nutFields</div><div class="ttdoc">List of snapshots for the solution for eddy viscosity.</div><div class="ttdef"><b>Definition</b> <a href="SteadyNSTurb_8H_source.html#l00077">SteadyNSTurb.H:77</a></div></div>
<div class="ttc" id="aclassreductionProblem_html_a5614ff6de814707075dba94edcd48c5e"><div class="ttname"><a href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">reductionProblem::counter</a></div><div class="ttdeci">label counter</div><div class="ttdoc">Counter used for the output of the full order solutions.</div><div class="ttdef"><b>Definition</b> <a href="reductionProblem_8H_source.html#l00110">reductionProblem.H:110</a></div></div>
<div class="ttc" id="aclassreductionProblem_html_a58ac7e74dd757c1e96bffead2b49ec80"><div class="ttname"><a href="classreductionProblem.html#a58ac7e74dd757c1e96bffead2b49ec80">reductionProblem::assignBC</a></div><div class="ttdeci">void assignBC(volVectorField &amp;s, label BC_ind, Vector&lt; double &gt; &amp;value)</div><div class="ttdoc">Assign Boundary Condition to a volVectorField.</div><div class="ttdef"><b>Definition</b> <a href="reductionProblem_8C_source.html#l00162">reductionProblem.C:162</a></div></div>
<div class="ttc" id="aclassreductionProblem_html_a752b5e2d6094c1ee18da4850443f1617"><div class="ttname"><a href="classreductionProblem.html#a752b5e2d6094c1ee18da4850443f1617">reductionProblem::offline</a></div><div class="ttdeci">bool offline</div><div class="ttdoc">Boolean variable, it is 1 if the Offline phase has already been computed, else 0.</div><div class="ttdef"><b>Definition</b> <a href="reductionProblem_8H_source.html#l00099">reductionProblem.H:99</a></div></div>
<div class="ttc" id="aclassreductionProblem_html_acca797c9e7595c83d45d40c286b9a6ee"><div class="ttname"><a href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">reductionProblem::mu</a></div><div class="ttdeci">Eigen::MatrixXd mu</div><div class="ttdoc">Row matrix of parameters.</div><div class="ttdef"><b>Definition</b> <a href="reductionProblem_8H_source.html#l00089">reductionProblem.H:89</a></div></div>
<div class="ttc" id="aclassreductionProblem_html_aeab985e1958591a9de375c415c8d5e8d"><div class="ttname"><a href="classreductionProblem.html#aeab985e1958591a9de375c415c8d5e8d">reductionProblem::truthSolve</a></div><div class="ttdeci">void truthSolve()</div><div class="ttdoc">Perform a TruthSolve.</div><div class="ttdef"><b>Definition</b> <a href="reductionProblem_8C_source.html#l00097">reductionProblem.C:97</a></div></div>
<div class="ttc" id="aclasssteadyNS_html_a30b8d9c76cc7f7f4d7dd6406cedba537"><div class="ttname"><a href="classsteadyNS.html#a30b8d9c76cc7f7f4d7dd6406cedba537">steadyNS::Pfield</a></div><div class="ttdeci">PtrList&lt; volScalarField &gt; Pfield</div><div class="ttdoc">List of pointers used to form the pressure snapshots matrix.</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00086">steadyNS.H:86</a></div></div>
<div class="ttc" id="aclasssteadyNS_html_a4efe3474afaa557ad5a211631115124f"><div class="ttname"><a href="classsteadyNS.html#a4efe3474afaa557ad5a211631115124f">steadyNS::Ufield</a></div><div class="ttdeci">PtrList&lt; volVectorField &gt; Ufield</div><div class="ttdoc">List of pointers used to form the velocity snapshots matrix.</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00089">steadyNS.H:89</a></div></div>
<div class="ttc" id="aclasssteadyNS_html_ada27c7fb3a1597b8a6de151dccd79f9a"><div class="ttname"><a href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">steadyNS::Uinl</a></div><div class="ttdeci">autoPtr&lt; volVectorField &gt; Uinl</div><div class="ttdoc">Initial dummy field with all Dirichlet boundary conditions.</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00281">steadyNS.H:281</a></div></div>
<div class="ttc" id="anamespaceITHACAstream_html_aa552d7dbbbd8f204bbf55b07836da550"><div class="ttname"><a href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a></div><div class="ttdeci">void read_fields(PtrList&lt; GeometricField&lt; Type, PatchField, GeoMesh &gt; &gt; &amp;Lfield, word Name, fileName casename, int first_snap, int n_snap)</div><div class="ttdoc">Function to read a list of fields from the name of the field and casename.</div><div class="ttdef"><b>Definition</b> <a href="ITHACAstream_8C_source.html#l00516">ITHACAstream.C:516</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H_html_ac23c63c7750d8829a77f4ebe1d961c48"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a></div><div class="ttdeci">label i</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H_source.html#l00046">pEqn.H:46</a></div></div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                Vector&lt;double&gt; <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>(0, 0, 0);</div>
<div class="line">                label BCind = 0;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (label <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> = 0; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> &lt; <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>.rows(); <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>++)</div>
<div class="line">                {</div>
<div class="line">                    <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>[0] = <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>, 0);</div>
<div class="line">                    <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>[1] = <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>, 1);</div>
<div class="line">                    <a class="code hl_function" href="classreductionProblem.html#a58ac7e74dd757c1e96bffead2b49ec80">assignBC</a>(<a class="code hl_variable" href="classsteadyNS.html#ae8b03bc316b446d3ad311a80c5ada715">_U</a>(), BCind, <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>);</div>
<div class="line">                    <a class="code hl_function" href="classreductionProblem.html#aeab985e1958591a9de375c415c8d5e8d">truthSolve</a>(<span class="stringliteral">&quot;./ITHACAoutput/Offline/&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
</div><!-- fragment --><p> This offlineSolve method is just designed to compute the full order solutions for a set of parameters samples called par, the goal is to compute the full order solution for a cross validation test samples which will be used to test the reduced order model in the online stage.</p>
<div class="fragment"><div class="line">        <span class="keywordtype">void</span> <a class="code hl_function" href="classtutorial06.html#aecc518758bcaae3b0a514db77e6263cf">offlineSolve</a>(Eigen::MatrixXd par, fileName folder)</div>
<div class="line">        {</div>
<div class="line">            Vector&lt;double&gt; inl(0, 0, 0);</div>
<div class="line">            List&lt;scalar&gt; mu_now(2);</div>
<div class="line">            Vector&lt;double&gt; <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>(0, 0, 0);</div>
<div class="line">            label BCind = 0;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (label <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> = 0; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> &lt; par.rows(); <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>++)</div>
<div class="line">            {</div>
<div class="line">                <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>[0] = par(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>, 0);</div>
<div class="line">                <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>[1] = par(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>, 1);</div>
<div class="line">                <a class="code hl_function" href="classreductionProblem.html#a58ac7e74dd757c1e96bffead2b49ec80">assignBC</a>(<a class="code hl_variable" href="classsteadyNS.html#ae8b03bc316b446d3ad311a80c5ada715">_U</a>(), BCind, <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>);</div>
<div class="line">                <a class="code hl_function" href="classreductionProblem.html#aeab985e1958591a9de375c415c8d5e8d">truthSolve</a>(folder);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">void</span> <a class="code hl_function" href="classreductionProblem.html#aeab985e1958591a9de375c415c8d5e8d">truthSolve</a>(fileName folder)</div>
<div class="line">        {</div>
<div class="line">            Time&amp; <a class="code hl_variable" href="ITHACA__CORE_2ITHACAsensitivity_2FiguresOfMerit_2createTime_8H.html#a477812c93e1698f206b3c3266041d0fd">runTime</a> = <a id="a21" name="a21"></a><a class="code hl_variable" href="classsteadyNS.html#a4493d1f1ce7e2008c85b1dde7c027de4">_runTime</a>();</div>
<div class="line">            fvMesh&amp; <a class="code hl_variable" href="ITHACA__CORE_2ITHACAsensitivity_2FiguresOfMerit_2createMesh_8H.html#ad3874bb3b9ab8a24930b4793e928108d">mesh</a> = <a id="a22" name="a22"></a><a class="code hl_variable" href="classsteadyNS.html#a6a233a5c129864684e67e41d04983e01">_mesh</a>();</div>
<div class="line">            volScalarField&amp; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#a334650304cdcdff41898bee9eaf2e3db">p</a> = <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#ad87eff8426f119b54f0ae7841940306b">_p</a>();</div>
<div class="line">            volVectorField&amp; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#ae4919c063fc0646445cdcafee89ebd60">U</a> = <a class="code hl_variable" href="classsteadyNS.html#ae8b03bc316b446d3ad311a80c5ada715">_U</a>();</div>
<div class="line">            surfaceScalarField&amp; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#a1a97abcf6c141f539994c8a21c8daca7">phi</a> = <a id="a23" name="a23"></a><a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2UnsteadyNSExplicit_2createFields_8H.html#a40162fde1df058a2278666d0bc39a8e2">_phi</a>();</div>
<div class="line">            fv::options&amp; <a class="code hl_variable" href="NLsolve_8H.html#a17798bb69ca5f9a5d28c2a824053b8a6">fvOptions</a> = <a id="a24" name="a24"></a><a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFvOptions_8H.html#a74771b34ee266ad9dbbc9e01872aa7b4">_fvOptions</a>();</div>
<div class="line">            simpleControl&amp; <a class="code hl_function" href="solveTrue_8H.html#a4ff7399a07d87b6d34b5b5a6ea68644c">simple</a> = <a id="a25" name="a25"></a><a class="code hl_variable" href="classsteadyNS.html#a2eedc2d1f931744a2e2ba785d803eb5f">_simple</a>();</div>
<div class="line">            IOMRFZoneList&amp; MRF = <a id="a26" name="a26"></a><a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#ab6622d3fa81ea4ad8462f16aa6a8da07">_MRF</a>();</div>
<div class="line">            singlePhaseTransportModel&amp; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2createFields_8H.html#aaa15f2fa61d58ef55036975f0a15cd3d">laminarTransport</a> = <a id="a27" name="a27"></a><a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2createFields_8H.html#a2196113e1201a3f47ea70ae5e2193751">_laminarTransport</a>();</div>
<div class="line"><span class="preprocessor">#include &quot;NLsolveSteadyNSTurb.H&quot;</span></div>
<div class="line">            <a id="a28" name="a28"></a><a class="code hl_function" href="namespaceITHACAstream.html#a36ae0d53d94f890fdfe72086003eacee">ITHACAstream::exportSolution</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#ae4919c063fc0646445cdcafee89ebd60">U</a>, name(<a class="code hl_variable" href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">counter</a>), folder);</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAstream.html#a36ae0d53d94f890fdfe72086003eacee">ITHACAstream::exportSolution</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#a334650304cdcdff41898bee9eaf2e3db">p</a>, name(<a class="code hl_variable" href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">counter</a>), folder);</div>
<div class="line">            volScalarField <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2SteadyNSTurb_2createFields_8H.html#a6474dce93ee9fd1d383863a810d832e3">_nut</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2createFields_8H.html#a7eb708ed6afd5d2b8cec73f71e0ff2d4">turbulence</a>-&gt;nut());</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAstream.html#a36ae0d53d94f890fdfe72086003eacee">ITHACAstream::exportSolution</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2SteadyNSTurb_2createFields_8H.html#a6474dce93ee9fd1d383863a810d832e3">_nut</a>, name(<a class="code hl_variable" href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">counter</a>), folder);</div>
<div class="line">            <a class="code hl_variable" href="classsteadyNS.html#a4efe3474afaa557ad5a211631115124f">Ufield</a>.append((<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#ae4919c063fc0646445cdcafee89ebd60">U</a>).clone());</div>
<div class="line">            <a class="code hl_variable" href="classsteadyNS.html#a30b8d9c76cc7f7f4d7dd6406cedba537">Pfield</a>.append((<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#a334650304cdcdff41898bee9eaf2e3db">p</a>).clone());</div>
<div class="line">            <a class="code hl_variable" href="classSteadyNSTurb.html#a4bda4f74c0cf2abe5f4096c663b7a8a8">nutFields</a>.append((<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2SteadyNSTurb_2createFields_8H.html#a6474dce93ee9fd1d383863a810d832e3">_nut</a>).clone());</div>
<div class="line">            <a class="code hl_variable" href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">counter</a>++;</div>
<div class="line">        }</div>
<div class="line">};</div>
<div class="ttc" id="aITHACA__CORE_2ITHACAsensitivity_2FiguresOfMerit_2createMesh_8H_html_ad3874bb3b9ab8a24930b4793e928108d"><div class="ttname"><a href="ITHACA__CORE_2ITHACAsensitivity_2FiguresOfMerit_2createMesh_8H.html#ad3874bb3b9ab8a24930b4793e928108d">mesh</a></div><div class="ttdeci">Foam::fvMesh &amp; mesh</div><div class="ttdef"><b>Definition</b> <a href="ITHACA__CORE_2ITHACAsensitivity_2FiguresOfMerit_2createMesh_8H_source.html#l00047">createMesh.H:47</a></div></div>
<div class="ttc" id="aITHACA__CORE_2ITHACAsensitivity_2FiguresOfMerit_2createTime_8H_html_a477812c93e1698f206b3c3266041d0fd"><div class="ttname"><a href="ITHACA__CORE_2ITHACAsensitivity_2FiguresOfMerit_2createTime_8H.html#a477812c93e1698f206b3c3266041d0fd">runTime</a></div><div class="ttdeci">Foam::Time &amp; runTime</div><div class="ttdef"><b>Definition</b> <a href="ITHACA__CORE_2ITHACAsensitivity_2FiguresOfMerit_2createTime_8H_source.html#l00033">createTime.H:33</a></div></div>
<div class="ttc" id="aNLsolve_8H_html_a17798bb69ca5f9a5d28c2a824053b8a6"><div class="ttname"><a href="NLsolve_8H.html#a17798bb69ca5f9a5d28c2a824053b8a6">fvOptions</a></div><div class="ttdeci">fv::options &amp; fvOptions</div><div class="ttdef"><b>Definition</b> <a href="NLsolve_8H_source.html#l00025">NLsolve.H:25</a></div></div>
<div class="ttc" id="aclasssteadyNS_html_a2eedc2d1f931744a2e2ba785d803eb5f"><div class="ttname"><a href="classsteadyNS.html#a2eedc2d1f931744a2e2ba785d803eb5f">steadyNS::_simple</a></div><div class="ttdeci">autoPtr&lt; simpleControl &gt; _simple</div><div class="ttdoc">simpleControl</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00293">steadyNS.H:293</a></div></div>
<div class="ttc" id="aclasssteadyNS_html_a4493d1f1ce7e2008c85b1dde7c027de4"><div class="ttname"><a href="classsteadyNS.html#a4493d1f1ce7e2008c85b1dde7c027de4">steadyNS::_runTime</a></div><div class="ttdeci">autoPtr&lt; Time &gt; _runTime</div><div class="ttdoc">Time.</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00299">steadyNS.H:299</a></div></div>
<div class="ttc" id="aclasssteadyNS_html_a6a233a5c129864684e67e41d04983e01"><div class="ttname"><a href="classsteadyNS.html#a6a233a5c129864684e67e41d04983e01">steadyNS::_mesh</a></div><div class="ttdeci">autoPtr&lt; fvMesh &gt; _mesh</div><div class="ttdoc">Mesh.</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00290">steadyNS.H:290</a></div></div>
<div class="ttc" id="anamespaceITHACAstream_html_a36ae0d53d94f890fdfe72086003eacee"><div class="ttname"><a href="namespaceITHACAstream.html#a36ae0d53d94f890fdfe72086003eacee">ITHACAstream::exportSolution</a></div><div class="ttdeci">void exportSolution(GeometricField&lt; Type, PatchField, GeoMesh &gt; &amp;s, fileName subfolder, fileName folder, word fieldName)</div><div class="ttdoc">Export a field to file in a certain folder and subfolder.</div><div class="ttdef"><b>Definition</b> <a href="ITHACAstream_8C_source.html#l00904">ITHACAstream.C:904</a></div></div>
<div class="ttc" id="asolveTrue_8H_html_a4ff7399a07d87b6d34b5b5a6ea68644c"><div class="ttname"><a href="solveTrue_8H.html#a4ff7399a07d87b6d34b5b5a6ea68644c">simple</a></div><div class="ttdeci">simpleControl simple(mesh)</div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H_html_a1a97abcf6c141f539994c8a21c8daca7"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#a1a97abcf6c141f539994c8a21c8daca7">phi</a></div><div class="ttdeci">surfaceScalarField &amp; phi</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H_source.html#l00068">createFields.H:68</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2Burgers_2createFvOptions_8H_html_a74771b34ee266ad9dbbc9e01872aa7b4"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFvOptions_8H.html#a74771b34ee266ad9dbbc9e01872aa7b4">_fvOptions</a></div><div class="ttdeci">_fvOptions</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFvOptions_8H_source.html#l00026">createFvOptions.H:26</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H_html_ab6622d3fa81ea4ad8462f16aa6a8da07"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#ab6622d3fa81ea4ad8462f16aa6a8da07">_MRF</a></div><div class="ttdeci">_MRF</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H_source.html#l00142">createFields.H:142</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2UnsteadyNSExplicit_2createFields_8H_html_a40162fde1df058a2278666d0bc39a8e2"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2UnsteadyNSExplicit_2createFields_8H.html#a40162fde1df058a2278666d0bc39a8e2">_phi</a></div><div class="ttdeci">_phi</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2UnsteadyNSExplicit_2createFields_8H_source.html#l00110">createFields.H:110</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2msrProblem_2createFields_8H_html_a2196113e1201a3f47ea70ae5e2193751"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2createFields_8H.html#a2196113e1201a3f47ea70ae5e2193751">_laminarTransport</a></div><div class="ttdeci">_laminarTransport</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2createFields_8H_source.html#l00082">createFields.H:82</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2msrProblem_2createFields_8H_html_a7eb708ed6afd5d2b8cec73f71e0ff2d4"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2createFields_8H.html#a7eb708ed6afd5d2b8cec73f71e0ff2d4">turbulence</a></div><div class="ttdeci">turbulence</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2createFields_8H_source.html#l00088">createFields.H:88</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2msrProblem_2createFields_8H_html_aaa15f2fa61d58ef55036975f0a15cd3d"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2createFields_8H.html#aaa15f2fa61d58ef55036975f0a15cd3d">laminarTransport</a></div><div class="ttdeci">singlePhaseTransportModel &amp; laminarTransport</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2createFields_8H_source.html#l00086">createFields.H:86</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="main"></a>
Definition of the main function</h2>
<p>In this section we address the definition of the main function. First we construct the object "example" of type <a class="el" href="classtutorial06.html" title="Class where the tutorial number 6 is implemented.">tutorial06</a>:</p>
<div class="fragment"><div class="line">    <a class="code hl_class" href="classtutorial06.html">tutorial06</a> example(argc, argv);</div>
</div><!-- fragment --><p>Then we read the parameters samples for the offline stage and the ones for the online stages using method readMatrix in the <a class="el" href="namespaceITHACAstream.html" title="Namespace for input-output manipulation.">ITHACAstream</a> class</p>
<div class="fragment"><div class="line">    word par_offline(<span class="stringliteral">&quot;./par_offline&quot;</span>);</div>
<div class="line">    word par_new(<span class="stringliteral">&quot;./par_online&quot;</span>);</div>
<div class="line">    Eigen::MatrixXd par_online = <a id="a29" name="a29"></a><a class="code hl_function" href="namespaceITHACAstream.html#aa259fffbddd2f4a42cc3a4a76f839ef6">ITHACAstream::readMatrix</a>(par_new);</div>
<div class="line">    example.mu = <a class="code hl_function" href="namespaceITHACAstream.html#aa259fffbddd2f4a42cc3a4a76f839ef6">ITHACAstream::readMatrix</a>(par_offline);</div>
<div class="ttc" id="anamespaceITHACAstream_html_aa259fffbddd2f4a42cc3a4a76f839ef6"><div class="ttname"><a href="namespaceITHACAstream.html#aa259fffbddd2f4a42cc3a4a76f839ef6">ITHACAstream::readMatrix</a></div><div class="ttdeci">List&lt; Eigen::MatrixXd &gt; readMatrix(word folder, word mat_name)</div><div class="ttdoc">Read a three dimensional matrix from a txt file in Eigen format.</div><div class="ttdef"><b>Definition</b> <a href="ITHACAstream_8C_source.html#l00372">ITHACAstream.C:372</a></div></div>
</div><!-- fragment --><p> Then we set the inlet boundaries where we have parameterized boundary conditions and we define in which directions we have the parameterization. </p><div class="fragment"><div class="line">    example.inletIndex.resize(2, 2);</div>
<div class="line">    example.inletIndex(0, 0) = 0;</div>
<div class="line">    example.inletIndex(0, 1) = 0;</div>
<div class="line">    example.inletIndex(1, 0) = 0;</div>
<div class="line">    example.inletIndex(1, 1) = 1;</div>
</div><!-- fragment --><p>Then we parse the ITHACAdict file to determine the number of modes to be written out and also the ones to be used for the projection of the velocity, pressure, supremizer and the eddy viscosity:</p>
<div class="fragment"><div class="line">    <a id="_a30" name="_a30"></a><a class="code hl_class" href="classITHACAparameters.html">ITHACAparameters</a>* <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a> = <a id="a31" name="a31"></a><a class="code hl_function" href="classITHACAparameters.html#adf4e7e15954b8779d57ed6478a19027f">ITHACAparameters::getInstance</a>(example._mesh(),</div>
<div class="ttc" id="aNLsolve_8H_html_a8fe34eb12dd4c1271bb9123ed6982124"><div class="ttname"><a href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a></div><div class="ttdeci">ITHACAparameters * para</div><div class="ttdef"><b>Definition</b> <a href="NLsolve_8H_source.html#l00040">NLsolve.H:40</a></div></div>
<div class="ttc" id="aclassITHACAparameters_html"><div class="ttname"><a href="classITHACAparameters.html">ITHACAparameters</a></div><div class="ttdoc">Class for the definition of some general parameters, the parameters must be defined from the file ITH...</div><div class="ttdef"><b>Definition</b> <a href="ITHACAparameters_8H_source.html#l00040">ITHACAparameters.H:41</a></div></div>
<div class="ttc" id="aclassITHACAparameters_html_adf4e7e15954b8779d57ed6478a19027f"><div class="ttname"><a href="classITHACAparameters.html#adf4e7e15954b8779d57ed6478a19027f">ITHACAparameters::getInstance</a></div><div class="ttdeci">static ITHACAparameters * getInstance()</div><div class="ttdoc">Gets an instance of ITHACAparameters, to be used if the instance is already existing.</div><div class="ttdef"><b>Definition</b> <a href="ITHACAparameters_8C_source.html#l00056">ITHACAparameters.C:56</a></div></div>
<div class="line">                             example._runTime());</div>
<div class="line">    <span class="comment">// Read parameters from ITHACAdict file</span></div>
<div class="line">    <span class="keywordtype">int</span> NmodesU = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesU&quot;</span>, 5);</div>
<div class="line">    <span class="keywordtype">int</span> NmodesP = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesP&quot;</span>, 5);</div>
<div class="line">    <span class="keywordtype">int</span> NmodesSUP = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesSUP&quot;</span>, 5);</div>
<div class="line">    <span class="keywordtype">int</span> NmodesNUT = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesNUT&quot;</span>, 5);</div>
<div class="line">    <span class="keywordtype">int</span> NmodesProject = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesProject&quot;</span>, 5);</div>
</div><!-- fragment --><p> Now we are ready to perform the offline stage: </p><div class="fragment"><div class="line">    example.offlineSolve();</div>
</div><!-- fragment --><p> The next step is to read the lifting functions </p><div class="fragment"><div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a>(example.liftfield, example.U, <span class="stringliteral">&quot;./lift/&quot;</span>);</div>
</div><!-- fragment --><p> Then we compute the homogeneous velocity field snapshots, and then we output them </p><div class="fragment"><div class="line">    example.computeLift(example.Ufield, example.liftfield, example.Uomfield);</div>
<div class="line">    <span class="comment">// Export the homogeneous velocity snapshots</span></div>
<div class="line">    <a id="a32" name="a32"></a><a class="code hl_function" href="namespaceITHACAstream.html#a27a963f84ff21cab923b5b491667bcf9">ITHACAstream::exportFields</a>(example.Uomfield, <span class="stringliteral">&quot;./ITHACAoutput/Offline&quot;</span>,</div>
<div class="ttc" id="anamespaceITHACAstream_html_a27a963f84ff21cab923b5b491667bcf9"><div class="ttname"><a href="namespaceITHACAstream.html#a27a963f84ff21cab923b5b491667bcf9">ITHACAstream::exportFields</a></div><div class="ttdeci">void exportFields(PtrList&lt; GeometricField&lt; Type, PatchField, GeoMesh &gt; &gt; &amp;field, word folder, word fieldname)</div><div class="ttdoc">Function to export a scalar of vector field.</div><div class="ttdef"><b>Definition</b> <a href="ITHACAstream_8C_source.html#l00874">ITHACAstream.C:874</a></div></div>
</div><!-- fragment --><p> After that, the modes for velocity, pressure and the eddy viscosity are obtained: </p><div class="fragment"><div class="line">    <a id="a33" name="a33"></a><a class="code hl_function" href="namespaceITHACAPOD.html#aa66f8357143947aa1c3359627eeb0ddd">ITHACAPOD::getModes</a>(example.Uomfield, example.Umodes, example._U().name(),</div>
<div class="ttc" id="anamespaceITHACAPOD_html_aa66f8357143947aa1c3359627eeb0ddd"><div class="ttname"><a href="namespaceITHACAPOD.html#aa66f8357143947aa1c3359627eeb0ddd">ITHACAPOD::getModes</a></div><div class="ttdeci">void getModes(PtrList&lt; GeometricField&lt; Type, PatchField, GeoMesh &gt; &gt; &amp;snapshots, PtrList&lt; GeometricField&lt; Type, PatchField, GeoMesh &gt; &gt; &amp;modes, word fieldName, bool podex, bool supex, bool sup, label nmodes, bool correctBC)</div><div class="ttdoc">Computes the bases or reads them for a field.</div><div class="ttdef"><b>Definition</b> <a href="ITHACAPOD_8C_source.html#l00090">ITHACAPOD.C:90</a></div></div>
<div class="line">                        example.podex,</div>
<div class="line">                        example.supex, 0, NmodesProject);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAPOD.html#aa66f8357143947aa1c3359627eeb0ddd">ITHACAPOD::getModes</a>(example.Pfield, example.Pmodes, example.p().name(),</div>
<div class="line">                        example.podex,</div>
<div class="line">                        example.supex, 0, NmodesProject);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAPOD.html#aa66f8357143947aa1c3359627eeb0ddd">ITHACAPOD::getModes</a>(example.nutFields, example.nutModes, example._nut().name(),</div>
</div><!-- fragment --><p> Then we compute the supremizer modes on the basis of the POD pressure modes obtained from the last step</p>
<div class="fragment"><div class="line">        example.solvesupremizer(<span class="stringliteral">&quot;modes&quot;</span>);</div>
</div><!-- fragment --><p> then we perform the projection onto the POD modes </p><div class="fragment"><div class="line">        example.projectSUP(<span class="stringliteral">&quot;./Matrices&quot;</span>, NmodesU, NmodesP, NmodesSUP,</div>
</div><!-- fragment --><p> Now we proceed to the ROM part of the tutorial, at first we construct an object of the class &lt;<a class="el" href="ReducedSteadyNSTurb_8H.html" title="Header file of the ReducedSteadyNSTurb class.">ReducedSteadyNSTurb.H</a>&gt;.</p>
<div class="fragment"><div class="line">    <span class="comment">// Set value of the reduced viscosity and the penalty factor</span></div>
</div><!-- fragment --><p> Now we set the value of the reduced viscosity and we initialize the penalty factor which will be zero</p>
<div class="fragment"><div class="line">    pod_rbf.nu = 1e-3;</div>
<div class="line">    pod_rbf.tauU.resize(2, 1);</div>
</div><!-- fragment --><p> We create the matrix rbfCoeff in order to store the values of the interpolated eddy viscosity coefficient using the RBF in the online stage</p>
<div class="fragment"><div class="line">    <span class="comment">// We create the matrix rbfCoeff which will store the values of the interpolation results for the eddy viscosity field</span></div>
<div class="line">    Eigen::MatrixXd rbfCoeff;</div>
</div><!-- fragment --><p> Now we solve the online reduced system for the parameter values stored in par_online which is a different set of samples for the parameters than the one used in the offline stage. This represent a cross validation test for assessing the reduced order model in a better way.</p>
<div class="fragment"><div class="line">    <span class="comment">// Perform an online solve for the new values of inlet velocities</span></div>
<div class="line">    <span class="keywordflow">for</span> (label k = 0; k &lt; par_online.rows(); k++)</div>
<div class="line">    {</div>
<div class="line">        Eigen::MatrixXd velNow(2, 1);</div>
<div class="line">        velNow(0, 0) = par_online(k, 0);</div>
<div class="line">        velNow(1, 0) = par_online(k, 1);</div>
<div class="line">        pod_rbf.tauU(0, 0) = 0;</div>
<div class="line">        pod_rbf.tauU(1, 0) = 0;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (stabilization == <span class="stringliteral">&quot;supremizer&quot;</span>)</div>
<div class="line">        {</div>
<div class="line">            pod_rbf.solveOnlineSUP(velNow);</div>
<div class="line">        }</div>
</div><!-- fragment --><p> Now we output the matrix rbfCoeff and the online solution</p>
<div class="fragment"><div class="line">        rbfCoeff.col(k) = pod_rbf.rbfCoeff;</div>
<div class="line">        Eigen::MatrixXd tmp_sol(pod_rbf.y.rows() + 1, 1);</div>
<div class="line">        tmp_sol(0) = k + 1;</div>
<div class="line">        tmp_sol.col(0).tail(pod_rbf.y.rows()) = pod_rbf.y;</div>
<div class="line">        pod_rbf.online_solution.append(tmp_sol);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Save the matrix of interpolated eddy viscosity coefficients</span></div>
<div class="line">    <a id="a34" name="a34"></a><a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(rbfCoeff, <span class="stringliteral">&quot;rbfCoeff&quot;</span>, <span class="stringliteral">&quot;python&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/Matrices/&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(rbfCoeff, <span class="stringliteral">&quot;rbfCoeff&quot;</span>, <span class="stringliteral">&quot;matlab&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/Matrices/&quot;</span>);</div>
<div class="line">    <span class="comment">// Save the online solution</span></div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(pod_rbf.online_solution, <span class="stringliteral">&quot;red_coeff&quot;</span>, <span class="stringliteral">&quot;python&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/red_coeff&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(pod_rbf.online_solution, <span class="stringliteral">&quot;red_coeff&quot;</span>, <span class="stringliteral">&quot;matlab&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/red_coeff&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(pod_rbf.online_solution, <span class="stringliteral">&quot;red_coeff&quot;</span>, <span class="stringliteral">&quot;eigen&quot;</span>,</div>
<div class="ttc" id="anamespaceITHACAstream_html_a483b7ea851dae940e8651c1fea9e5def"><div class="ttname"><a href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a></div><div class="ttdeci">void exportMatrix(Eigen::Matrix&lt; T, -1, dim &gt; &amp;matrix, word Name, word type, word folder)</div><div class="ttdoc">Export the reduced matrices in numpy (type=python), matlab (type=matlab) and txt (type=eigen) format ...</div><div class="ttdef"><b>Definition</b> <a href="ITHACAstream_8C_source.html#l00055">ITHACAstream.C:55</a></div></div>
</div><!-- fragment --><p> The last step is to reconstruct the velocity and pressure fields using the reduced solution obtained in the online stage and with the POD modes computed earlier on</p>
<div class="fragment"><div class="line">    pod_rbf.reconstruct(<span class="keyword">true</span>, <span class="stringliteral">&quot;./ITHACAoutput/Reconstruction/&quot;</span>);</div>
<div class="line">    <span class="comment">// Create an object of the laminar class</span></div>
<div class="line">    <a id="_a35" name="_a35"></a><a class="code hl_class" href="classreducedSteadyNS.html">reducedSteadyNS</a> pod_normal(</div>
<div class="line">        example);</div>
<div class="line">    <span class="comment">// Set value of the reduced viscosity and the penalty factor</span></div>
<div class="line">    pod_normal.nu = 1e-3;</div>
<div class="line">    pod_normal.tauU.resize(2, 1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Perform an online solve for the new values of inlet velocities</span></div>
<div class="line">    <span class="keywordflow">for</span> (label k = 0; k &lt; par_online.rows(); k++)</div>
<div class="line">    {</div>
<div class="line">        Eigen::MatrixXd vel_now(2, 1);</div>
<div class="line">        vel_now(0, 0) = par_online(k, 0);</div>
<div class="line">        vel_now(1, 0) = par_online(k, 1);</div>
<div class="line">        pod_normal.tauU(0, 0) = 0;</div>
<div class="line">        pod_normal.tauU(1, 0) = 0;</div>
<div class="line">        pod_normal.solveOnline_sup(vel_now);</div>
<div class="line">        Eigen::MatrixXd tmp_sol(pod_normal.y.rows() + 1, 1);</div>
<div class="line">        tmp_sol(0) = k + 1;</div>
<div class="line">        tmp_sol.col(0).tail(pod_normal.y.rows()) = pod_normal.y;</div>
<div class="line">        pod_normal.online_solution.append(tmp_sol);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Save the online solution</span></div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(pod_normal.online_solution, <span class="stringliteral">&quot;red_coeffnew&quot;</span>, <span class="stringliteral">&quot;python&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/red_coeffnew&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(pod_normal.online_solution, <span class="stringliteral">&quot;red_coeffnew&quot;</span>, <span class="stringliteral">&quot;matlab&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/red_coeffnew&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(pod_normal.online_solution, <span class="stringliteral">&quot;red_coeffnew&quot;</span>, <span class="stringliteral">&quot;eigen&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/red_coeffnew&quot;</span>);</div>
<div class="line">    <span class="comment">// Reconstruct and export the solution</span></div>
<div class="line">    pod_normal.reconstruct(<span class="keyword">true</span>, <span class="stringliteral">&quot;./ITHACAoutput/Lam_Rec/&quot;</span>);</div>
<div class="line">    <span class="comment">// Solve the full order problem for the online velocity values for the purpose of comparison</span></div>
<div class="line">    <span class="comment">// if (ITHACAutilities::check_folder(&quot;./ITHACAoutput/Offline_check&quot;) == false)</span></div>
<div class="line">    <span class="comment">// {</span></div>
<div class="line">    <span class="comment">//     example.offlineSolve(par_online, &quot;./ITHACAoutput/Offline_check/&quot;);</span></div>
<div class="line">    <span class="comment">//     ITHACAutilities::createSymLink(&quot;./ITHACAoutput/Offline_check&quot;);</span></div>
<div class="line">    <span class="comment">// }</span></div>
<div class="line">    Eigen::MatrixXd errFrobU = <a id="a36" name="a36"></a><a class="code hl_function" href="namespaceITHACAutilities.html#a856e33455b0de468877010d4dc036d0e">ITHACAutilities::errorFrobRel</a>(example.Ufield,</div>
<div class="line">                               pod_rbf.uRecFields);</div>
<div class="line">    Eigen::MatrixXd errFrobP =  <a class="code hl_function" href="namespaceITHACAutilities.html#a856e33455b0de468877010d4dc036d0e">ITHACAutilities::errorFrobRel</a>(example.Pfield,</div>
<div class="line">                                pod_rbf.pRecFields);</div>
<div class="line">    Eigen::MatrixXd errFrobNut =  <a class="code hl_function" href="namespaceITHACAutilities.html#a856e33455b0de468877010d4dc036d0e">ITHACAutilities::errorFrobRel</a>(example.nutFields,</div>
<div class="line">                                  pod_rbf.nutRecFields);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(errFrobU, <span class="stringliteral">&quot;errFrobU&quot;</span>, <span class="stringliteral">&quot;matlab&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/ErrorsFrob/&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(errFrobP, <span class="stringliteral">&quot;errFrobP&quot;</span>, <span class="stringliteral">&quot;matlab&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/ErrorsFrob/&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(errFrobNut, <span class="stringliteral">&quot;errFrobNut&quot;</span>, <span class="stringliteral">&quot;matlab&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/ErrorsFrob/&quot;</span>);</div>
<div class="line">    Eigen::MatrixXd errL2U = <a id="a37" name="a37"></a><a class="code hl_function" href="namespaceITHACAutilities.html#a814b1de101df996e4b57607e514b6a24">ITHACAutilities::errorL2Rel</a>(example.Ufield,</div>
<div class="line">                             pod_rbf.uRecFields);</div>
<div class="line">    Eigen::MatrixXd errL2P =  <a class="code hl_function" href="namespaceITHACAutilities.html#a814b1de101df996e4b57607e514b6a24">ITHACAutilities::errorL2Rel</a>(example.Pfield,</div>
<div class="line">                              pod_rbf.pRecFields);</div>
<div class="line">    Eigen::MatrixXd errL2Nut =  <a class="code hl_function" href="namespaceITHACAutilities.html#a814b1de101df996e4b57607e514b6a24">ITHACAutilities::errorL2Rel</a>(example.nutFields,</div>
<div class="line">                                pod_rbf.nutRecFields);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(errL2U, <span class="stringliteral">&quot;errL2U&quot;</span>, <span class="stringliteral">&quot;matlab&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/ErrorsL2/&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(errL2P, <span class="stringliteral">&quot;errL2P&quot;</span>, <span class="stringliteral">&quot;matlab&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/ErrorsL2/&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(errL2Nut, <span class="stringliteral">&quot;errL2Nut&quot;</span>, <span class="stringliteral">&quot;matlab&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/ErrorsL2/&quot;</span>);</div>
<div class="line">    exit(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//--------</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="ttc" id="aclassreducedSteadyNS_html"><div class="ttname"><a href="classreducedSteadyNS.html">reducedSteadyNS</a></div><div class="ttdoc">Class where it is implemented a reduced problem for the  steady Navier-stokes  problem.</div><div class="ttdef"><b>Definition</b> <a href="ReducedSteadyNS_8H_source.html#l00085">ReducedSteadyNS.H:86</a></div></div>
<div class="ttc" id="anamespaceITHACAutilities_html_a814b1de101df996e4b57607e514b6a24"><div class="ttname"><a href="namespaceITHACAutilities.html#a814b1de101df996e4b57607e514b6a24">ITHACAutilities::errorL2Rel</a></div><div class="ttdeci">double errorL2Rel(GeometricField&lt; T, fvPatchField, volMesh &gt; &amp;field1, GeometricField&lt; T, fvPatchField, volMesh &gt; &amp;field2, List&lt; label &gt; *labels)</div><div class="ttdoc">Computes the relative error between two geometric Fields in L2 norm.</div><div class="ttdef"><b>Definition</b> <a href="ITHACAerror_8C_source.html#l00369">ITHACAerror.C:369</a></div></div>
<div class="ttc" id="anamespaceITHACAutilities_html_a856e33455b0de468877010d4dc036d0e"><div class="ttname"><a href="namespaceITHACAutilities.html#a856e33455b0de468877010d4dc036d0e">ITHACAutilities::errorFrobRel</a></div><div class="ttdeci">double errorFrobRel(GeometricField&lt; Type, PatchField, GeoMesh &gt; &amp;field1, GeometricField&lt; Type, PatchField, GeoMesh &gt; &amp;field2, List&lt; label &gt; *labels)</div><div class="ttdoc">Computes the relative error between two Fields in the Frobenius norm.</div><div class="ttdef"><b>Definition</b> <a href="ITHACAerror_8C_source.html#l00078">ITHACAerror.C:78</a></div></div>
</div><!-- fragment --><p> After we carried out the online stage using an object of the turbulent class &lt;<a class="el" href="ReducedSteadyNSTurb_8H.html" title="Header file of the ReducedSteadyNSTurb class.">ReducedSteadyNSTurb.H</a>&gt;, now we will repeat same procedure but for the class that does not take into consideration turbulence at the reduced order level which is &lt;reducedSteadyNS.H&gt;. This allows us at the end of comparing the reduced results obtained from both classes.</p>
<div class="fragment"><div class="line"></div>
<div class="line"></div>
</div><!-- fragment --><p> We finally solve the offline stage for the checking parameters set that was used for validating the reduced order model </p><div class="fragment"><div class="line"></div>
<div class="line"></div>
</div><!-- fragment --> <div class="fragment"><div class="line"><span class="comment">/*---------------------------------------------------------------------------*\</span></div>
<div class="line"><span class="comment">     âââââââââââââââ  âââ ââââââ  âââââââ ââââââ       âââââââââââ   âââ</span></div>
<div class="line"><span class="comment">     âââââââââââââââ  âââââââââââââââââââââââââââ      âââââââââââ   âââ</span></div>
<div class="line"><span class="comment">     âââ   âââ   âââââââââââââââââââ     ââââââââââââââââââââ  âââ   âââ</span></div>
<div class="line"><span class="comment">     âââ   âââ   âââââââââââââââââââ     ââââââââââââââââââââ  ââââ ââââ</span></div>
<div class="line"><span class="comment">     âââ   âââ   âââ  ââââââ  ââââââââââââââ  âââ      âââ      âââââââ</span></div>
<div class="line"><span class="comment">     âââ   âââ   âââ  ââââââ  âââ ââââââââââ  âââ      âââ       âââââ</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> * In real Time Highly Advanced Computational Applications for Finite Volumes</span></div>
<div class="line"><span class="comment"> * Copyright (C) 2017 by the ITHACA-FV authors</span></div>
<div class="line"><span class="comment">-------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">License</span></div>
<div class="line"><span class="comment">    This file is part of ITHACA-FV</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    ITHACA-FV is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment">    it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><span class="comment">    the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment">    (at your option) any later version.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    ITHACA-FV is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div>
<div class="line"><span class="comment">    GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment">    along with ITHACA-FV. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">Description</span></div>
<div class="line"><span class="comment">    Example of NS-Stokes Reduction Problem for Turbulent Flow Case</span></div>
<div class="line"><span class="comment">SourceFiles</span></div>
<div class="line"><span class="comment">    06POD_RBF.C</span></div>
<div class="line"><span class="comment">\*---------------------------------------------------------------------------*/</span></div>
<div class="line"><span class="preprocessor">#include &quot;fvCFD.H&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;fvOptions.H&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;IOmanip.H&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;simpleControl.H&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ITHACAutilities_8H.html">ITHACAutilities.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="Foam2Eigen_8H.html">Foam2Eigen.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ITHACAstream_8H.html">ITHACAstream.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ITHACAPOD_8H.html">ITHACAPOD.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Eigen/Dense&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Eigen/SVD&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Eigen/SparseLU&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="EigenFunctions_8H.html">EigenFunctions.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="reductionProblem_8H.html">reductionProblem.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="steadyNS_8H.html">steadyNS.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SteadyNSTurb_8H.html">SteadyNSTurb.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ReducedSteadyNS_8H.html">ReducedSteadyNS.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ReducedSteadyNSTurb_8H.html">ReducedSteadyNSTurb.H</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classtutorial06.html">tutorial06</a> : <span class="keyword">public</span> <a class="code hl_class" href="classSteadyNSTurb.html">SteadyNSTurb</a></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        <span class="keyword">explicit</span> <a class="code hl_function" href="classtutorial06.html#a7a63444769e473558ba02b6135d38858">tutorial06</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">            :</div>
<div class="line">            <a class="code hl_function" href="classSteadyNSTurb.html#acf59090fea98d6e00a1ea8156ae9469e">SteadyNSTurb</a>(argc, argv),</div>
<div class="line">            <a id="a38" name="a38"></a><a class="code hl_variable" href="classtutorial06.html#a33b6b6be45459eb32c9b86d46c5ef790">U</a>(<a class="code hl_variable" href="classsteadyNS.html#ae8b03bc316b446d3ad311a80c5ada715">_U</a>()),</div>
<div class="line">            <a id="a39" name="a39"></a><a class="code hl_variable" href="classtutorial06.html#a6369844e0ed5847d056a9c3ec5945fe4">p</a>(<a id="a40" name="a40"></a><a class="code hl_variable" href="classsteadyNS.html#afe342c9980231332bb8c22bbceb32254">_p</a>()),</div>
<div class="line">            <a id="a41" name="a41"></a><a class="code hl_variable" href="classtutorial06.html#acbeb0c573672cb74aa2c757ea64ea951">nut</a>(<a id="a42" name="a42"></a><a class="code hl_variable" href="classSteadyNSTurb.html#a43d6ca286d08b8715a79fbcd1b6ef29d">_nut</a>())</div>
<div class="line">        {}</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Relevant Fields</span></div>
<div class="line">        volVectorField&amp; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#ae4919c063fc0646445cdcafee89ebd60">U</a>;</div>
<div class="line">        volScalarField&amp; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#a334650304cdcdff41898bee9eaf2e3db">p</a>;</div>
<div class="line">        volScalarField&amp; <a class="code hl_variable" href="NLsolve_8H.html#accb6562fe0a89c5cdf51fd48160731dd">nut</a>;</div>
<div class="line">        <span class="keywordtype">void</span> <a class="code hl_function" href="classtutorial06.html#aecc518758bcaae3b0a514db77e6263cf">offlineSolve</a>()</div>
<div class="line">        {</div>
<div class="line">            Vector&lt;double&gt; inl(0, 0, 0);</div>
<div class="line">            List&lt;scalar&gt; mu_now(2);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// if the offline solution is already performed read the fields</span></div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classreductionProblem.html#a752b5e2d6094c1ee18da4850443f1617">offline</a>)</div>
<div class="line">            {</div>
<div class="line">                <a class="code hl_function" href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a>(<a class="code hl_variable" href="classsteadyNS.html#a4efe3474afaa557ad5a211631115124f">Ufield</a>, <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#ae4919c063fc0646445cdcafee89ebd60">U</a>, <span class="stringliteral">&quot;./ITHACAoutput/Offline/&quot;</span>);</div>
<div class="line">                <a class="code hl_function" href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a>(<a class="code hl_variable" href="classsteadyNS.html#a30b8d9c76cc7f7f4d7dd6406cedba537">Pfield</a>, <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#a334650304cdcdff41898bee9eaf2e3db">p</a>, <span class="stringliteral">&quot;./ITHACAoutput/Offline/&quot;</span>);</div>
<div class="line">                <a class="code hl_function" href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a>(<a class="code hl_variable" href="classSteadyNSTurb.html#a4bda4f74c0cf2abe5f4096c663b7a8a8">nutFields</a>, <a class="code hl_variable" href="NLsolve_8H.html#accb6562fe0a89c5cdf51fd48160731dd">nut</a>, <span class="stringliteral">&quot;./ITHACAoutput/Offline/&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// if the offline stage is not completed then resume it</span></div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classsteadyNS.html#a4efe3474afaa557ad5a211631115124f">Ufield</a>.size() &lt; <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>.rows())</div>
<div class="line">                {</div>
<div class="line">                    Vector&lt;double&gt; <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>(0, 0, 0);</div>
<div class="line">                    label BCind = 0;</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">for</span> (label <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> = <a class="code hl_variable" href="classsteadyNS.html#a4efe3474afaa557ad5a211631115124f">Ufield</a>.size(); <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> &lt; <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>.rows(); <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>++)</div>
<div class="line">                    {</div>
<div class="line">                        <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>[0] = <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>, 0);</div>
<div class="line">                        <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>[1] = <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>, 1);</div>
<div class="line">                        <a class="code hl_function" href="classreductionProblem.html#a58ac7e74dd757c1e96bffead2b49ec80">assignBC</a>(<a class="code hl_variable" href="classsteadyNS.html#ae8b03bc316b446d3ad311a80c5ada715">_U</a>(), BCind, <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>);</div>
<div class="line">                        <a class="code hl_variable" href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">counter</a> = <a class="code hl_variable" href="classsteadyNS.html#a4efe3474afaa557ad5a211631115124f">Ufield</a>.size() + 1;</div>
<div class="line">                        <a class="code hl_function" href="classreductionProblem.html#aeab985e1958591a9de375c415c8d5e8d">truthSolve</a>(<span class="stringliteral">&quot;./ITHACAoutput/Offline/&quot;</span>);</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                Vector&lt;double&gt; <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>(0, 0, 0);</div>
<div class="line">                label BCind = 0;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (label <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> = 0; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> &lt; <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>.rows(); <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>++)</div>
<div class="line">                {</div>
<div class="line">                    <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>[0] = <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>, 0);</div>
<div class="line">                    <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>[1] = <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>, 1);</div>
<div class="line">                    <a class="code hl_function" href="classreductionProblem.html#a58ac7e74dd757c1e96bffead2b49ec80">assignBC</a>(<a class="code hl_variable" href="classsteadyNS.html#ae8b03bc316b446d3ad311a80c5ada715">_U</a>(), BCind, <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>);</div>
<div class="line">                    <a class="code hl_function" href="classreductionProblem.html#aeab985e1958591a9de375c415c8d5e8d">truthSolve</a>(<span class="stringliteral">&quot;./ITHACAoutput/Offline/&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">void</span> <a class="code hl_function" href="classtutorial06.html#aecc518758bcaae3b0a514db77e6263cf">offlineSolve</a>(Eigen::MatrixXd par, fileName folder)</div>
<div class="line">        {</div>
<div class="line">            Vector&lt;double&gt; inl(0, 0, 0);</div>
<div class="line">            List&lt;scalar&gt; mu_now(2);</div>
<div class="line">            Vector&lt;double&gt; <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>(0, 0, 0);</div>
<div class="line">            label BCind = 0;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (label <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> = 0; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> &lt; par.rows(); <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>++)</div>
<div class="line">            {</div>
<div class="line">                <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>[0] = par(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>, 0);</div>
<div class="line">                <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>[1] = par(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>, 1);</div>
<div class="line">                <a class="code hl_function" href="classreductionProblem.html#a58ac7e74dd757c1e96bffead2b49ec80">assignBC</a>(<a class="code hl_variable" href="classsteadyNS.html#ae8b03bc316b446d3ad311a80c5ada715">_U</a>(), BCind, <a class="code hl_variable" href="classsteadyNS.html#ada27c7fb3a1597b8a6de151dccd79f9a">Uinl</a>);</div>
<div class="line">                <a class="code hl_function" href="classreductionProblem.html#aeab985e1958591a9de375c415c8d5e8d">truthSolve</a>(folder);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">void</span> <a class="code hl_function" href="classreductionProblem.html#aeab985e1958591a9de375c415c8d5e8d">truthSolve</a>(fileName folder)</div>
<div class="line">        {</div>
<div class="line">            Time&amp; <a class="code hl_variable" href="ITHACA__CORE_2ITHACAsensitivity_2FiguresOfMerit_2createTime_8H.html#a477812c93e1698f206b3c3266041d0fd">runTime</a> = <a class="code hl_variable" href="classsteadyNS.html#a4493d1f1ce7e2008c85b1dde7c027de4">_runTime</a>();</div>
<div class="line">            fvMesh&amp; <a class="code hl_variable" href="ITHACA__CORE_2ITHACAsensitivity_2FiguresOfMerit_2createMesh_8H.html#ad3874bb3b9ab8a24930b4793e928108d">mesh</a> = <a class="code hl_variable" href="classsteadyNS.html#a6a233a5c129864684e67e41d04983e01">_mesh</a>();</div>
<div class="line">            volScalarField&amp; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#a334650304cdcdff41898bee9eaf2e3db">p</a> = <a class="code hl_variable" href="classsteadyNS.html#afe342c9980231332bb8c22bbceb32254">_p</a>();</div>
<div class="line">            volVectorField&amp; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#ae4919c063fc0646445cdcafee89ebd60">U</a> = <a class="code hl_variable" href="classsteadyNS.html#ae8b03bc316b446d3ad311a80c5ada715">_U</a>();</div>
<div class="line">            surfaceScalarField&amp; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#a1a97abcf6c141f539994c8a21c8daca7">phi</a> = <a id="a43" name="a43"></a><a class="code hl_variable" href="classsteadyNS.html#a27dd336cf3b9757ba406b3d3926ac299">_phi</a>();</div>
<div class="line">            fv::options&amp; <a class="code hl_variable" href="NLsolve_8H.html#a17798bb69ca5f9a5d28c2a824053b8a6">fvOptions</a> = <a id="a44" name="a44"></a><a class="code hl_variable" href="classsteadyNS.html#a404c448879353c38f3d3121d6afc1802">_fvOptions</a>();</div>
<div class="line">            simpleControl&amp; <a class="code hl_function" href="solveTrue_8H.html#a4ff7399a07d87b6d34b5b5a6ea68644c">simple</a> = <a class="code hl_variable" href="classsteadyNS.html#a2eedc2d1f931744a2e2ba785d803eb5f">_simple</a>();</div>
<div class="line">            IOMRFZoneList&amp; MRF = <a id="a45" name="a45"></a><a class="code hl_variable" href="classsteadyNS.html#a99bd483228d60f47cd8ed4ed61a57472">_MRF</a>();</div>
<div class="line">            singlePhaseTransportModel&amp; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2createFields_8H.html#aaa15f2fa61d58ef55036975f0a15cd3d">laminarTransport</a> = <a id="a46" name="a46"></a><a class="code hl_variable" href="classsteadyNS.html#a6a8bb2d446609e075c792818ddefc2ed">_laminarTransport</a>();</div>
<div class="line"><span class="preprocessor">#include &quot;NLsolveSteadyNSTurb.H&quot;</span></div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAstream.html#a36ae0d53d94f890fdfe72086003eacee">ITHACAstream::exportSolution</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#ae4919c063fc0646445cdcafee89ebd60">U</a>, name(<a class="code hl_variable" href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">counter</a>), folder);</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAstream.html#a36ae0d53d94f890fdfe72086003eacee">ITHACAstream::exportSolution</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#a334650304cdcdff41898bee9eaf2e3db">p</a>, name(<a class="code hl_variable" href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">counter</a>), folder);</div>
<div class="line">            volScalarField <a class="code hl_variable" href="classSteadyNSTurb.html#a43d6ca286d08b8715a79fbcd1b6ef29d">_nut</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2createFields_8H.html#a7eb708ed6afd5d2b8cec73f71e0ff2d4">turbulence</a>-&gt;nut());</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAstream.html#a36ae0d53d94f890fdfe72086003eacee">ITHACAstream::exportSolution</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2SteadyNSTurb_2createFields_8H.html#a6474dce93ee9fd1d383863a810d832e3">_nut</a>, name(<a class="code hl_variable" href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">counter</a>), folder);</div>
<div class="line">            <a class="code hl_variable" href="classsteadyNS.html#a4efe3474afaa557ad5a211631115124f">Ufield</a>.append((<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2Burgers_2createFields_8H.html#ae4919c063fc0646445cdcafee89ebd60">U</a>).clone());</div>
<div class="line">            <a class="code hl_variable" href="classsteadyNS.html#a30b8d9c76cc7f7f4d7dd6406cedba537">Pfield</a>.append((<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2CompressibleSteadyNS_2createFields_8H.html#a334650304cdcdff41898bee9eaf2e3db">p</a>).clone());</div>
<div class="line">            <a class="code hl_variable" href="classSteadyNSTurb.html#a4bda4f74c0cf2abe5f4096c663b7a8a8">nutFields</a>.append((<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2SteadyNSTurb_2createFields_8H.html#a6474dce93ee9fd1d383863a810d832e3">_nut</a>).clone());</div>
<div class="line">            <a class="code hl_variable" href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">counter</a>++;</div>
<div class="line">        }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a id="a47" name="a47"></a><a class="code hl_function" href="extract__time__evolution_8C.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Construct the tutorial06 object</span></div>
<div class="line">    <a class="code hl_class" href="classtutorial06.html">tutorial06</a> example(argc, argv);</div>
<div class="line">    <span class="comment">// Read parameters samples for the offline stage and the ones for the online stages</span></div>
<div class="line">    word par_offline(<span class="stringliteral">&quot;./par_offline&quot;</span>);</div>
<div class="line">    word par_new(<span class="stringliteral">&quot;./par_online&quot;</span>);</div>
<div class="line">    Eigen::MatrixXd par_online = <a class="code hl_function" href="namespaceITHACAstream.html#aa259fffbddd2f4a42cc3a4a76f839ef6">ITHACAstream::readMatrix</a>(par_new);</div>
<div class="line">    example.mu = <a class="code hl_function" href="namespaceITHACAstream.html#aa259fffbddd2f4a42cc3a4a76f839ef6">ITHACAstream::readMatrix</a>(par_offline);</div>
<div class="line">    <span class="comment">// Set the inlet boundaries where we have parameterized boundary conditions</span></div>
<div class="line">    example.inletIndex.resize(2, 2);</div>
<div class="line">    example.inletIndex(0, 0) = 0;</div>
<div class="line">    example.inletIndex(0, 1) = 0;</div>
<div class="line">    example.inletIndex(1, 0) = 0;</div>
<div class="line">    example.inletIndex(1, 1) = 1;</div>
<div class="line">    <a class="code hl_class" href="classITHACAparameters.html">ITHACAparameters</a>* <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a> = <a class="code hl_function" href="classITHACAparameters.html#adf4e7e15954b8779d57ed6478a19027f">ITHACAparameters::getInstance</a>(example._mesh(),</div>
<div class="line">                             example._runTime());</div>
<div class="line">    <span class="comment">// Read parameters from ITHACAdict file</span></div>
<div class="line">    <span class="keywordtype">int</span> NmodesU = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesU&quot;</span>, 5);</div>
<div class="line">    <span class="keywordtype">int</span> NmodesP = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesP&quot;</span>, 5);</div>
<div class="line">    <span class="keywordtype">int</span> NmodesSUP = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesSUP&quot;</span>, 5);</div>
<div class="line">    <span class="keywordtype">int</span> NmodesNUT = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesNUT&quot;</span>, 5);</div>
<div class="line">    <span class="keywordtype">int</span> NmodesProject = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesProject&quot;</span>, 5);</div>
<div class="line">    word stabilization = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;word&gt;(<span class="stringliteral">&quot;Stabilization&quot;</span>,</div>
<div class="line">                         <span class="stringliteral">&quot;supremizer&quot;</span>);</div>
<div class="line">    <span class="comment">// Perform The Offline Solve;</span></div>
<div class="line">    example.offlineSolve();</div>
<div class="line">    <span class="comment">// Read the lift functions</span></div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a>(example.liftfield, example.U, <span class="stringliteral">&quot;./lift/&quot;</span>);</div>
<div class="line">    <span class="comment">// Create the homogeneous set of snapshots for the velocity field</span></div>
<div class="line">    example.computeLift(example.Ufield, example.liftfield, example.Uomfield);</div>
<div class="line">    <span class="comment">// Export the homogeneous velocity snapshots</span></div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a27a963f84ff21cab923b5b491667bcf9">ITHACAstream::exportFields</a>(example.Uomfield, <span class="stringliteral">&quot;./ITHACAoutput/Offline&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;Uofield&quot;</span>);</div>
<div class="line">    <span class="comment">// Perform a POD decomposition for the velocity, the pressure and the eddy viscosity</span></div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAPOD.html#aa66f8357143947aa1c3359627eeb0ddd">ITHACAPOD::getModes</a>(example.Uomfield, example.Umodes, example._U().name(),</div>
<div class="line">                        example.podex,</div>
<div class="line">                        example.supex, 0, NmodesProject);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAPOD.html#aa66f8357143947aa1c3359627eeb0ddd">ITHACAPOD::getModes</a>(example.Pfield, example.Pmodes, example.p().name(),</div>
<div class="line">                        example.podex,</div>
<div class="line">                        example.supex, 0, NmodesProject);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAPOD.html#aa66f8357143947aa1c3359627eeb0ddd">ITHACAPOD::getModes</a>(example.nutFields, example.nutModes, example._nut().name(),</div>
<div class="line">                        example.podex,</div>
<div class="line">                        example.supex, 0, NmodesProject);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Solve the supremizer problem based on the pressure modes</span></div>
<div class="line">    <span class="keywordflow">if</span> (stabilization == <span class="stringliteral">&quot;supremizer&quot;</span>)</div>
<div class="line">    {</div>
<div class="line">        example.solvesupremizer(<span class="stringliteral">&quot;modes&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Compute the reduced order matrices</span></div>
<div class="line">    <span class="comment">// Get reduced matrices</span></div>
<div class="line">    <span class="keywordflow">if</span> (stabilization == <span class="stringliteral">&quot;supremizer&quot;</span>)</div>
<div class="line">    {</div>
<div class="line">        example.projectSUP(<span class="stringliteral">&quot;./Matrices&quot;</span>, NmodesU, NmodesP, NmodesSUP,</div>
<div class="line">                           NmodesNUT);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stabilization == <span class="stringliteral">&quot;PPE&quot;</span>)</div>
<div class="line">    {</div>
<div class="line">        example.projectPPE(<span class="stringliteral">&quot;./Matrices&quot;</span>, NmodesU, NmodesP, NmodesSUP,</div>
<div class="line">                           NmodesNUT);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create an object of the turbulent class</span></div>
<div class="line">    <a id="_a48" name="_a48"></a><a class="code hl_class" href="classReducedSteadyNSTurb.html">ReducedSteadyNSTurb</a> pod_rbf(</div>
<div class="line">        example);</div>
<div class="line">    <span class="comment">// Set value of the reduced viscosity and the penalty factor</span></div>
<div class="line">    pod_rbf.nu = 1e-3;</div>
<div class="line">    pod_rbf.tauU.resize(2, 1);</div>
<div class="line">    <span class="comment">// We create the matrix rbfCoeff which will store the values of the interpolation results for the eddy viscosity field</span></div>
<div class="line">    Eigen::MatrixXd rbfCoeff;</div>
<div class="line">    rbfCoeff.resize(NmodesNUT, par_online.rows());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Perform an online solve for the new values of inlet velocities</span></div>
<div class="line">    <span class="keywordflow">for</span> (label k = 0; k &lt; par_online.rows(); k++)</div>
<div class="line">    {</div>
<div class="line">        Eigen::MatrixXd velNow(2, 1);</div>
<div class="line">        velNow(0, 0) = par_online(k, 0);</div>
<div class="line">        velNow(1, 0) = par_online(k, 1);</div>
<div class="line">        pod_rbf.tauU(0, 0) = 0;</div>
<div class="line">        pod_rbf.tauU(1, 0) = 0;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (stabilization == <span class="stringliteral">&quot;supremizer&quot;</span>)</div>
<div class="line">        {</div>
<div class="line">            pod_rbf.solveOnlineSUP(velNow);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stabilization == <span class="stringliteral">&quot;PPE&quot;</span>)</div>
<div class="line">        {</div>
<div class="line">            pod_rbf.solveOnlinePPE(velNow);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        rbfCoeff.col(k) = pod_rbf.rbfCoeff;</div>
<div class="line">        Eigen::MatrixXd tmp_sol(pod_rbf.y.rows() + 1, 1);</div>
<div class="line">        tmp_sol(0) = k + 1;</div>
<div class="line">        tmp_sol.col(0).tail(pod_rbf.y.rows()) = pod_rbf.y;</div>
<div class="line">        pod_rbf.online_solution.append(tmp_sol);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Save the matrix of interpolated eddy viscosity coefficients</span></div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(rbfCoeff, <span class="stringliteral">&quot;rbfCoeff&quot;</span>, <span class="stringliteral">&quot;python&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/Matrices/&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(rbfCoeff, <span class="stringliteral">&quot;rbfCoeff&quot;</span>, <span class="stringliteral">&quot;matlab&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/Matrices/&quot;</span>);</div>
<div class="line">    <span class="comment">// Save the online solution</span></div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(pod_rbf.online_solution, <span class="stringliteral">&quot;red_coeff&quot;</span>, <span class="stringliteral">&quot;python&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/red_coeff&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(pod_rbf.online_solution, <span class="stringliteral">&quot;red_coeff&quot;</span>, <span class="stringliteral">&quot;matlab&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/red_coeff&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(pod_rbf.online_solution, <span class="stringliteral">&quot;red_coeff&quot;</span>, <span class="stringliteral">&quot;eigen&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/red_coeff&quot;</span>);</div>
<div class="line">    pod_rbf.rbfCoeffMat = rbfCoeff;</div>
<div class="line">    <span class="comment">// Reconstruct and export the solution</span></div>
<div class="line">    pod_rbf.reconstruct(<span class="keyword">true</span>, <span class="stringliteral">&quot;./ITHACAoutput/Reconstruction/&quot;</span>);</div>
<div class="line">    <span class="comment">// Create an object of the laminar class</span></div>
<div class="line">    <a class="code hl_class" href="classreducedSteadyNS.html">reducedSteadyNS</a> pod_normal(</div>
<div class="line">        example);</div>
<div class="line">    <span class="comment">// Set value of the reduced viscosity and the penalty factor</span></div>
<div class="line">    pod_normal.nu = 1e-3;</div>
<div class="line">    pod_normal.tauU.resize(2, 1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Perform an online solve for the new values of inlet velocities</span></div>
<div class="line">    <span class="keywordflow">for</span> (label k = 0; k &lt; par_online.rows(); k++)</div>
<div class="line">    {</div>
<div class="line">        Eigen::MatrixXd vel_now(2, 1);</div>
<div class="line">        vel_now(0, 0) = par_online(k, 0);</div>
<div class="line">        vel_now(1, 0) = par_online(k, 1);</div>
<div class="line">        pod_normal.tauU(0, 0) = 0;</div>
<div class="line">        pod_normal.tauU(1, 0) = 0;</div>
<div class="line">        pod_normal.solveOnline_sup(vel_now);</div>
<div class="line">        Eigen::MatrixXd tmp_sol(pod_normal.y.rows() + 1, 1);</div>
<div class="line">        tmp_sol(0) = k + 1;</div>
<div class="line">        tmp_sol.col(0).tail(pod_normal.y.rows()) = pod_normal.y;</div>
<div class="line">        pod_normal.online_solution.append(tmp_sol);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Save the online solution</span></div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(pod_normal.online_solution, <span class="stringliteral">&quot;red_coeffnew&quot;</span>, <span class="stringliteral">&quot;python&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/red_coeffnew&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(pod_normal.online_solution, <span class="stringliteral">&quot;red_coeffnew&quot;</span>, <span class="stringliteral">&quot;matlab&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/red_coeffnew&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(pod_normal.online_solution, <span class="stringliteral">&quot;red_coeffnew&quot;</span>, <span class="stringliteral">&quot;eigen&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/red_coeffnew&quot;</span>);</div>
<div class="line">    <span class="comment">// Reconstruct and export the solution</span></div>
<div class="line">    pod_normal.reconstruct(<span class="keyword">true</span>, <span class="stringliteral">&quot;./ITHACAoutput/Lam_Rec/&quot;</span>);</div>
<div class="line">    <span class="comment">// Solve the full order problem for the online velocity values for the purpose of comparison</span></div>
<div class="line">    <span class="comment">// if (ITHACAutilities::check_folder(&quot;./ITHACAoutput/Offline_check&quot;) == false)</span></div>
<div class="line">    <span class="comment">// {</span></div>
<div class="line">    <span class="comment">//     example.offlineSolve(par_online, &quot;./ITHACAoutput/Offline_check/&quot;);</span></div>
<div class="line">    <span class="comment">//     ITHACAutilities::createSymLink(&quot;./ITHACAoutput/Offline_check&quot;);</span></div>
<div class="line">    <span class="comment">// }</span></div>
<div class="line">    Eigen::MatrixXd errFrobU = <a class="code hl_function" href="namespaceITHACAutilities.html#a856e33455b0de468877010d4dc036d0e">ITHACAutilities::errorFrobRel</a>(example.Ufield,</div>
<div class="line">                               pod_rbf.uRecFields);</div>
<div class="line">    Eigen::MatrixXd errFrobP =  <a class="code hl_function" href="namespaceITHACAutilities.html#a856e33455b0de468877010d4dc036d0e">ITHACAutilities::errorFrobRel</a>(example.Pfield,</div>
<div class="line">                                pod_rbf.pRecFields);</div>
<div class="line">    Eigen::MatrixXd errFrobNut =  <a class="code hl_function" href="namespaceITHACAutilities.html#a856e33455b0de468877010d4dc036d0e">ITHACAutilities::errorFrobRel</a>(example.nutFields,</div>
<div class="line">                                  pod_rbf.nutRecFields);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(errFrobU, <span class="stringliteral">&quot;errFrobU&quot;</span>, <span class="stringliteral">&quot;matlab&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/ErrorsFrob/&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(errFrobP, <span class="stringliteral">&quot;errFrobP&quot;</span>, <span class="stringliteral">&quot;matlab&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/ErrorsFrob/&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(errFrobNut, <span class="stringliteral">&quot;errFrobNut&quot;</span>, <span class="stringliteral">&quot;matlab&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/ErrorsFrob/&quot;</span>);</div>
<div class="line">    Eigen::MatrixXd errL2U = <a class="code hl_function" href="namespaceITHACAutilities.html#a814b1de101df996e4b57607e514b6a24">ITHACAutilities::errorL2Rel</a>(example.Ufield,</div>
<div class="line">                             pod_rbf.uRecFields);</div>
<div class="line">    Eigen::MatrixXd errL2P =  <a class="code hl_function" href="namespaceITHACAutilities.html#a814b1de101df996e4b57607e514b6a24">ITHACAutilities::errorL2Rel</a>(example.Pfield,</div>
<div class="line">                              pod_rbf.pRecFields);</div>
<div class="line">    Eigen::MatrixXd errL2Nut =  <a class="code hl_function" href="namespaceITHACAutilities.html#a814b1de101df996e4b57607e514b6a24">ITHACAutilities::errorL2Rel</a>(example.nutFields,</div>
<div class="line">                                pod_rbf.nutRecFields);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(errL2U, <span class="stringliteral">&quot;errL2U&quot;</span>, <span class="stringliteral">&quot;matlab&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/ErrorsL2/&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(errL2P, <span class="stringliteral">&quot;errL2P&quot;</span>, <span class="stringliteral">&quot;matlab&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/ErrorsL2/&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a483b7ea851dae940e8651c1fea9e5def">ITHACAstream::exportMatrix</a>(errL2Nut, <span class="stringliteral">&quot;errL2Nut&quot;</span>, <span class="stringliteral">&quot;matlab&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;./ITHACAoutput/ErrorsL2/&quot;</span>);</div>
<div class="line">    exit(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//--------</span></div>
<div class="line"></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="ttc" id="aclassReducedSteadyNSTurb_html"><div class="ttname"><a href="classReducedSteadyNSTurb.html">ReducedSteadyNSTurb</a></div><div class="ttdoc">Class where it is implemented a reduced problem for the  steady turbulent Navier-stokes  problem.</div><div class="ttdef"><b>Definition</b> <a href="ReducedSteadyNSTurb_8H_source.html#l00120">ReducedSteadyNSTurb.H:121</a></div></div>
<div class="ttc" id="aclassSteadyNSTurb_html_a43d6ca286d08b8715a79fbcd1b6ef29d"><div class="ttname"><a href="classSteadyNSTurb.html#a43d6ca286d08b8715a79fbcd1b6ef29d">SteadyNSTurb::_nut</a></div><div class="ttdeci">autoPtr&lt; volScalarField &gt; _nut</div><div class="ttdoc">Eddy viscosity field.</div><div class="ttdef"><b>Definition</b> <a href="SteadyNSTurb_8H_source.html#l00128">SteadyNSTurb.H:128</a></div></div>
<div class="ttc" id="aclasssteadyNS_html_a27dd336cf3b9757ba406b3d3926ac299"><div class="ttname"><a href="classsteadyNS.html#a27dd336cf3b9757ba406b3d3926ac299">steadyNS::_phi</a></div><div class="ttdeci">autoPtr&lt; surfaceScalarField &gt; _phi</div><div class="ttdoc">Flux.</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00302">steadyNS.H:302</a></div></div>
<div class="ttc" id="aclasssteadyNS_html_a404c448879353c38f3d3121d6afc1802"><div class="ttname"><a href="classsteadyNS.html#a404c448879353c38f3d3121d6afc1802">steadyNS::_fvOptions</a></div><div class="ttdeci">autoPtr&lt; fv::options &gt; _fvOptions</div><div class="ttdoc">fvOptions</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00296">steadyNS.H:296</a></div></div>
<div class="ttc" id="aclasssteadyNS_html_a6a8bb2d446609e075c792818ddefc2ed"><div class="ttname"><a href="classsteadyNS.html#a6a8bb2d446609e075c792818ddefc2ed">steadyNS::_laminarTransport</a></div><div class="ttdeci">autoPtr&lt; singlePhaseTransportModel &gt; _laminarTransport</div><div class="ttdoc">Laminar transport (used by turbulence model)</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00311">steadyNS.H:311</a></div></div>
<div class="ttc" id="aclasssteadyNS_html_a99bd483228d60f47cd8ed4ed61a57472"><div class="ttname"><a href="classsteadyNS.html#a99bd483228d60f47cd8ed4ed61a57472">steadyNS::_MRF</a></div><div class="ttdeci">autoPtr&lt; IOMRFZoneList &gt; _MRF</div><div class="ttdoc">MRF variable.</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00314">steadyNS.H:314</a></div></div>
<div class="ttc" id="aclasssteadyNS_html_afe342c9980231332bb8c22bbceb32254"><div class="ttname"><a href="classsteadyNS.html#afe342c9980231332bb8c22bbceb32254">steadyNS::_p</a></div><div class="ttdeci">autoPtr&lt; volScalarField &gt; _p</div><div class="ttdoc">Pressure field.</div><div class="ttdef"><b>Definition</b> <a href="steadyNS_8H_source.html#l00269">steadyNS.H:269</a></div></div>
<div class="ttc" id="aclasstutorial06_html_a33b6b6be45459eb32c9b86d46c5ef790"><div class="ttname"><a href="classtutorial06.html#a33b6b6be45459eb32c9b86d46c5ef790">tutorial06::U</a></div><div class="ttdeci">volVectorField &amp; U</div><div class="ttdoc">[tutorial06]</div><div class="ttdef"><b>Definition</b> <a href="06POD__RBF_8C_source.html#l00068">06POD_RBF.C:68</a></div></div>
<div class="ttc" id="aclasstutorial06_html_a6369844e0ed5847d056a9c3ec5945fe4"><div class="ttname"><a href="classtutorial06.html#a6369844e0ed5847d056a9c3ec5945fe4">tutorial06::p</a></div><div class="ttdeci">volScalarField &amp; p</div><div class="ttdef"><b>Definition</b> <a href="06POD__RBF_8C_source.html#l00069">06POD_RBF.C:69</a></div></div>
<div class="ttc" id="aclasstutorial06_html_acbeb0c573672cb74aa2c757ea64ea951"><div class="ttname"><a href="classtutorial06.html#acbeb0c573672cb74aa2c757ea64ea951">tutorial06::nut</a></div><div class="ttdeci">volScalarField &amp; nut</div><div class="ttdef"><b>Definition</b> <a href="06POD__RBF_8C_source.html#l00070">06POD_RBF.C:70</a></div></div>
<div class="ttc" id="aextract__time__evolution_8C_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="extract__time__evolution_8C.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition</b> <a href="extract__time__evolution_8C_source.html#l00021">extract_time_evolution.C:21</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.13.2
</small></address>
</body>
</html>
