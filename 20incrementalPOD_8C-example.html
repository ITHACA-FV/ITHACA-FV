<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ITHACA-FV: 20incrementalPOD.C</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ithaca-fv-small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="">ITHACA-FV</a>
   &#160;<span id="projectnumber"><a href="">2023.1</a></span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">20incrementalPOD.C</div></div>
</div><!--header-->
<div class="contents">
<h1><a class="anchor" id="intro_IPOD"></a>
Introduction to the incremental POD tutorial</h1>
<p>In this tutorial, we test an incremental POD algorithm. The incremental POD algorithm implemented in ITHACA-FV is the one proposed by Oxberry et al. in the paper "Limited-memory adaptive snapshot selection
for proper orthogonal decomposition"</p>
<p>To test the algorithm, we use a parameterized heat conduction problem. The problem equations are:   </p><p class="formulaDsp">
\[\nabla \cdot (k \nabla T) = S
\]
</p>
<p> where \(k\) is the diffusivity, \(T\) is the temperature and \(S\) is the source term. The problem discretised and formalized in matrix equation reads:   </p><p class="formulaDsp">
\[AT = S
\]
</p>
<p> where \(A\) is the matrix of interpolation coefficients, \(T\) is the vector of unknowns and \(S\) is the vector representing the source term. The domain is subdivided in 9 different parts and each part has parametrized diffusivity. See the image below for a clarification. </p><div class="image">
<img src="drawing.png" alt=""/>
</div>
<p>In this tutorial, we solve the heat conduction problem for several values of the parameter to generate the snapshots. Then, we created the POD space from these snapshot using both the classical POD and the incremental POD. Finally, to test the goodness of the incremental POD space, we genereate one more solution for a new value of the parameters and project it onto the POD space. Computing the relative error of the projection, we can test if the incremental POD space is able to approximate the solution space.</p>
<h1><a class="anchor" id="code"></a>
The ITHACAPODdict file</h1>
<p>In this section are explained the main steps necessary to construct the tutorial N°2</p>
<h2><a class="anchor" id="header"></a>
The necessary header files</h2>
<p>First of all let's have a look to the header files that needs to be included and what they are responsible for:</p>
<p>The standard C++ header for input/output stream objects:</p>
<p></p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
</div><!-- fragment --><p> The OpenFOAM header files:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;fvCFD.H&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;IOmanip.H&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Time.H&quot;</span></div>
</div><!-- fragment --><p> The header file of ITHACA-FV necessary for this tutorial</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ITHACAPOD_8H.html">ITHACAPOD.H</a>&quot;</span></div>
<div class="ttc" id="aITHACAPOD_8H_html"><div class="ttname"><a href="ITHACAPOD_8H.html">ITHACAPOD.H</a></div><div class="ttdoc">Header file of the ITHACAPOD class.</div></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ITHACAutilities_8H.html">ITHACAutilities.H</a>&quot;</span></div>
<div class="ttc" id="aITHACAutilities_8H_html"><div class="ttname"><a href="ITHACAutilities_8H.html">ITHACAutilities.H</a></div><div class="ttdoc">Header file of the ITHACAutilities namespace.</div></div>
</div><!-- fragment --><p> The <a class="el" href="namespaceEigen.html">Eigen</a> library for matrix manipulation and linear and non-linear algebra operations:</p>
<div class="fragment"></div><!-- fragment --><p> And we define some mathematical constants and include the standard header for common math operations:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define _USE_MATH_DEFINES</span></div>
<div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div>
</div><!-- fragment --> <h2><a class="anchor" id="classtuto02"></a>
Implementation of the tutorial02 class</h2>
<p>Then we can define the <a class="el" href="classtutorialIPOD.html" title="Class where the tutorial number 20 is implemented.">tutorialIPOD</a> class as a child of the <a class="el" href="classlaplacianProblem.html" title="Class to implement a full order laplacian parametrized problem.">laplacianProblem</a> class</p>
<div class="fragment"><div class="line"><span class="keyword">class </span><a id="_a0" name="_a0"></a><a class="code hl_class" href="classtutorialIPOD.html">tutorialIPOD</a>: <span class="keyword">public</span> <a id="_a1" name="_a1"></a><a class="code hl_class" href="classlaplacianProblem.html">laplacianProblem</a></div>
<div class="ttc" id="aclasslaplacianProblem_html"><div class="ttname"><a href="classlaplacianProblem.html">laplacianProblem</a></div><div class="ttdoc">Class to implement a full order laplacian parametrized problem.</div><div class="ttdef"><b>Definition</b> <a href="laplacianProblem_8H_source.html#l00050">laplacianProblem.H:51</a></div></div>
<div class="ttc" id="aclasstutorialIPOD_html"><div class="ttname"><a href="classtutorialIPOD.html">tutorialIPOD</a></div><div class="ttdoc">Class where the tutorial number 20 is implemented.</div><div class="ttdef"><b>Definition</b> <a href="20incrementalPOD_8C_source.html#l00046">20incrementalPOD.C:47</a></div></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        <span class="keyword">explicit</span> <a id="a2" name="a2"></a><a class="code hl_function" href="classtutorialIPOD.html#a0eef636c08215037ea95e6e788a2595a">tutorialIPOD</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">            :</div>
<div class="line">            <a id="a3" name="a3"></a><a class="code hl_function" href="classlaplacianProblem.html#a7b70e752393c730c39ff25c4fb0ddbec">laplacianProblem</a>(argc, argv),</div>
<div class="line">            <a id="a4" name="a4"></a><a class="code hl_variable" href="createT_8H.html#ab35c96e5601691f7270cfadc745a12d3">T</a>(<a id="a5" name="a5"></a><a class="code hl_variable" href="createT_8H.html#a15d920713a31c7f6fa105e0ab1e5085a">_T</a>()),</div>
<div class="line">            <a id="a6" name="a6"></a><a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>(<a id="a7" name="a7"></a><a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2laplacianProblem_2createFields_8H.html#a751bfcd0535adc3c6e04d6f3ebbedd5d">_nu</a>()),</div>
<div class="line">            <a id="a8" name="a8"></a><a class="code hl_function" href="tutorials_2CFD_202thermalBlock_2createFields_8H.html#ae819a68dfc4ab3fb8011ad652efb475b">S</a>(<a id="a9" name="a9"></a><a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2laplacianProblem_2createFields_8H.html#ad82651f6fd3665f10155d4b307fab2d3">_S</a>())</div>
<div class="line">        {}</div>
<div class="ttc" id="aclasslaplacianProblem_html_a7b70e752393c730c39ff25c4fb0ddbec"><div class="ttname"><a href="classlaplacianProblem.html#a7b70e752393c730c39ff25c4fb0ddbec">laplacianProblem::laplacianProblem</a></div><div class="ttdeci">laplacianProblem()</div><div class="ttdef"><b>Definition</b> <a href="laplacianProblem_8C_source.html#l00040">laplacianProblem.C:40</a></div></div>
<div class="ttc" id="aclasstutorialIPOD_html_a0eef636c08215037ea95e6e788a2595a"><div class="ttname"><a href="classtutorialIPOD.html#a0eef636c08215037ea95e6e788a2595a">tutorialIPOD::tutorialIPOD</a></div><div class="ttdeci">tutorialIPOD(int argc, char *argv[])</div><div class="ttdef"><b>Definition</b> <a href="20incrementalPOD_8C_source.html#l00049">20incrementalPOD.C:49</a></div></div>
<div class="ttc" id="acreateT_8H_html_a15d920713a31c7f6fa105e0ab1e5085a"><div class="ttname"><a href="createT_8H.html#a15d920713a31c7f6fa105e0ab1e5085a">_T</a></div><div class="ttdeci">_T</div><div class="ttdef"><b>Definition</b> <a href="createT_8H_source.html#l00030">createT.H:30</a></div></div>
<div class="ttc" id="acreateT_8H_html_ab35c96e5601691f7270cfadc745a12d3"><div class="ttname"><a href="createT_8H.html#ab35c96e5601691f7270cfadc745a12d3">T</a></div><div class="ttdeci">volScalarField &amp; T</div><div class="ttdef"><b>Definition</b> <a href="createT_8H_source.html#l00046">createT.H:46</a></div></div>
<div class="ttc" id="amsrProblem_2readConstants_8H_html_a5b3df2ebbeca3bd7027c0ceb96a997e0"><div class="ttname"><a href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a></div><div class="ttdeci">dimensionedScalar &amp; nu</div><div class="ttdef"><b>Definition</b> <a href="msrProblem_2readConstants_8H_source.html#l00030">readConstants.H:30</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2laplacianProblem_2createFields_8H_html_a751bfcd0535adc3c6e04d6f3ebbedd5d"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2laplacianProblem_2createFields_8H.html#a751bfcd0535adc3c6e04d6f3ebbedd5d">_nu</a></div><div class="ttdeci">_nu</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2laplacianProblem_2createFields_8H_source.html#l00060">createFields.H:60</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2laplacianProblem_2createFields_8H_html_ad82651f6fd3665f10155d4b307fab2d3"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2laplacianProblem_2createFields_8H.html#ad82651f6fd3665f10155d4b307fab2d3">_S</a></div><div class="ttdeci">_S</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2laplacianProblem_2createFields_8H_source.html#l00043">createFields.H:43</a></div></div>
<div class="ttc" id="atutorials_2CFD_202thermalBlock_2createFields_8H_html_ae819a68dfc4ab3fb8011ad652efb475b"><div class="ttname"><a href="tutorials_2CFD_202thermalBlock_2createFields_8H.html#ae819a68dfc4ab3fb8011ad652efb475b">S</a></div><div class="ttdeci">volScalarField S(IOobject(&quot;S&quot;, runTime.timeName(), mesh, IOobject::NO_READ, IOobject::AUTO_WRITE), T.mesh(), dimensionedScalar(&quot;zero&quot;, dimensionSet(0, 0, -1, 1, 0, 0, 0), 0))</div></div>
</div><!-- fragment --><p> The members of the class are the fields that needs to be manipulated during the resolution of the problem</p>
<p>Inside the class it is defined the offline solve method according to the specific parametrized problem that needs to be solved.</p>
<div class="fragment"><div class="line">        <span class="keywordtype">void</span> <a id="a10" name="a10"></a><a class="code hl_function" href="classtutorialIPOD.html#af2e03379a7e6508fcfadc6d8457194b1">offlineSolve</a>(word folder = <span class="stringliteral">&quot;./ITHACAoutput/Offline/&quot;</span>)</div>
<div class="ttc" id="aclasstutorialIPOD_html_af2e03379a7e6508fcfadc6d8457194b1"><div class="ttname"><a href="classtutorialIPOD.html#af2e03379a7e6508fcfadc6d8457194b1">tutorialIPOD::offlineSolve</a></div><div class="ttdeci">void offlineSolve(word folder=&quot;./ITHACAoutput/Offline/&quot;)</div><div class="ttdoc">It perform an offline Solve.</div><div class="ttdef"><b>Definition</b> <a href="20incrementalPOD_8C_source.html#l00066">20incrementalPOD.C:66</a></div></div>
<div class="line">        {</div>
</div><!-- fragment --><p> If the offline solve has already been performed than read the existing snapshots</p>
<div class="fragment"><div class="line">            <span class="keywordflow">if</span> (<a id="a11" name="a11"></a><a class="code hl_variable" href="classreductionProblem.html#a752b5e2d6094c1ee18da4850443f1617">offline</a>)</div>
<div class="ttc" id="aclassreductionProblem_html_a752b5e2d6094c1ee18da4850443f1617"><div class="ttname"><a href="classreductionProblem.html#a752b5e2d6094c1ee18da4850443f1617">reductionProblem::offline</a></div><div class="ttdeci">bool offline</div><div class="ttdoc">Boolean variable, it is 1 if the Offline phase has already been computed, else 0.</div><div class="ttdef"><b>Definition</b> <a href="reductionProblem_8H_source.html#l00099">reductionProblem.H:99</a></div></div>
<div class="line">            {</div>
<div class="line">                <a id="a12" name="a12"></a><a class="code hl_function" href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a>(<a id="a13" name="a13"></a><a class="code hl_variable" href="classlaplacianProblem.html#ad79501e2e6be69c1846b01d62dd8328a">Tfield</a>, <span class="stringliteral">&quot;T&quot;</span>, folder);</div>
<div class="line">                <a id="a14" name="a14"></a><a class="code hl_variable" href="classreductionProblem.html#a30a31093d96229e8a53c26d26dbf96c1">mu_samples</a> =</div>
<div class="line">                    <a id="a15" name="a15"></a><a class="code hl_function" href="namespaceITHACAstream.html#aa259fffbddd2f4a42cc3a4a76f839ef6">ITHACAstream::readMatrix</a>(folder + <span class="stringliteral">&quot;/mu_samples_mat.txt&quot;</span>);</div>
<div class="line">            }</div>
<div class="ttc" id="aclasslaplacianProblem_html_ad79501e2e6be69c1846b01d62dd8328a"><div class="ttname"><a href="classlaplacianProblem.html#ad79501e2e6be69c1846b01d62dd8328a">laplacianProblem::Tfield</a></div><div class="ttdeci">PtrList&lt; volScalarField &gt; Tfield</div><div class="ttdoc">List of snapshots for the solution.</div><div class="ttdef"><b>Definition</b> <a href="laplacianProblem_8H_source.html#l00062">laplacianProblem.H:62</a></div></div>
<div class="ttc" id="aclassreductionProblem_html_a30a31093d96229e8a53c26d26dbf96c1"><div class="ttname"><a href="classreductionProblem.html#a30a31093d96229e8a53c26d26dbf96c1">reductionProblem::mu_samples</a></div><div class="ttdeci">Eigen::MatrixXd mu_samples</div><div class="ttdoc">Matrix of parameters to be used for PODI, where each row corresponds to a sample point....</div><div class="ttdef"><b>Definition</b> <a href="reductionProblem_8H_source.html#l00093">reductionProblem.H:93</a></div></div>
<div class="ttc" id="anamespaceITHACAstream_html_aa259fffbddd2f4a42cc3a4a76f839ef6"><div class="ttname"><a href="namespaceITHACAstream.html#aa259fffbddd2f4a42cc3a4a76f839ef6">ITHACAstream::readMatrix</a></div><div class="ttdeci">List&lt; Eigen::MatrixXd &gt; readMatrix(word folder, word mat_name)</div><div class="ttdoc">Read a three dimensional matrix from a txt file in Eigen format.</div><div class="ttdef"><b>Definition</b> <a href="ITHACAstream_8C_source.html#l00372">ITHACAstream.C:372</a></div></div>
<div class="ttc" id="anamespaceITHACAstream_html_aa552d7dbbbd8f204bbf55b07836da550"><div class="ttname"><a href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a></div><div class="ttdeci">void read_fields(PtrList&lt; GeometricField&lt; Type, PatchField, GeoMesh &gt; &gt; &amp;Lfield, word Name, fileName casename, int first_snap, int n_snap)</div><div class="ttdoc">Function to read a list of fields from the name of the field and casename.</div><div class="ttdef"><b>Definition</b> <a href="ITHACAstream_8C_source.html#l00516">ITHACAstream.C:516</a></div></div>
</div><!-- fragment --><p> else perform the offline solve where a loop over all the parameters is performed: </p><div class="fragment"><div class="line">                <span class="keywordflow">for</span> (label <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> = 0; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> &lt; <a id="a16" name="a16"></a><a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>.rows(); <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>++)</div>
<div class="ttc" id="aclassreductionProblem_html_acca797c9e7595c83d45d40c286b9a6ee"><div class="ttname"><a href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">reductionProblem::mu</a></div><div class="ttdeci">Eigen::MatrixXd mu</div><div class="ttdoc">Row matrix of parameters.</div><div class="ttdef"><b>Definition</b> <a href="reductionProblem_8H_source.html#l00089">reductionProblem.H:89</a></div></div>
<div class="ttc" id="asrc_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H_html_ac23c63c7750d8829a77f4ebe1d961c48"><div class="ttname"><a href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a></div><div class="ttdeci">label i</div><div class="ttdef"><b>Definition</b> <a href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H_source.html#l00046">pEqn.H:46</a></div></div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">for</span> (label j = 0; j &lt; <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>.cols() ; j++)</div>
<div class="line">                    {</div>
<div class="line">                        mu_now[j] = <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>, j);</div>
<div class="line">                        <a id="a17" name="a17"></a><a class="code hl_variable" href="classlaplacianProblem.html#a43d9eb706296997b1cf876423e044fb3">theta</a>[j] = <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>, j);</div>
<div class="line">                    }</div>
<div class="ttc" id="aclasslaplacianProblem_html_a43d9eb706296997b1cf876423e044fb3"><div class="ttname"><a href="classlaplacianProblem.html#a43d9eb706296997b1cf876423e044fb3">laplacianProblem::theta</a></div><div class="ttdeci">List&lt; scalar &gt; theta</div><div class="ttdoc">Theta (coefficients of the affine expansion)</div><div class="ttdef"><b>Definition</b> <a href="laplacianProblem_8H_source.html#l00074">laplacianProblem.H:74</a></div></div>
</div><!-- fragment --><p> a 0 internal constant value is assigned before each solve command with the lines</p>
<div class="fragment"><div class="line">                    <a id="a18" name="a18"></a><a class="code hl_function" href="classreductionProblem.html#a5c9c99f98e576423c196093a72e2ce98">assignIF</a>(<a class="code hl_variable" href="createT_8H.html#ab35c96e5601691f7270cfadc745a12d3">T</a>, IF);</div>
<div class="ttc" id="aclassreductionProblem_html_a5c9c99f98e576423c196093a72e2ce98"><div class="ttname"><a href="classreductionProblem.html#a5c9c99f98e576423c196093a72e2ce98">reductionProblem::assignIF</a></div><div class="ttdeci">void assignIF(T &amp;s, G &amp;value)</div><div class="ttdoc">Assign internal field condition.</div><div class="ttdef"><b>Definition</b> <a href="reductionProblemTemplates_8C_source.html#l00034">reductionProblemTemplates.C:34</a></div></div>
</div><!-- fragment --><p> and the solve operation is performed, see also the <a class="el" href="classlaplacianProblem.html" title="Class to implement a full order laplacian parametrized problem.">laplacianProblem</a> class for the definition of the methods</p>
<div class="fragment"><div class="line">                    <a id="a19" name="a19"></a><a class="code hl_function" href="classreductionProblem.html#aeab985e1958591a9de375c415c8d5e8d">truthSolve</a>(mu_now, folder);</div>
<div class="ttc" id="aclassreductionProblem_html_aeab985e1958591a9de375c415c8d5e8d"><div class="ttname"><a href="classreductionProblem.html#aeab985e1958591a9de375c415c8d5e8d">reductionProblem::truthSolve</a></div><div class="ttdeci">void truthSolve()</div><div class="ttdoc">Perform a TruthSolve.</div><div class="ttdef"><b>Definition</b> <a href="reductionProblem_8C_source.html#l00097">reductionProblem.C:97</a></div></div>
</div><!-- fragment --><p> The we need also to implement a method to set/define the source term that may be problem dependent. In this case the source term is defined with a hat function:</p>
<div class="fragment"><div class="line">        <span class="keywordtype">void</span> <a id="a20" name="a20"></a><a class="code hl_function" href="classtutorialIPOD.html#a78108e74dc4e17a624e30b779834df81">SetSource</a>()</div>
<div class="ttc" id="aclasstutorialIPOD_html_a78108e74dc4e17a624e30b779834df81"><div class="ttname"><a href="classtutorialIPOD.html#a78108e74dc4e17a624e30b779834df81">tutorialIPOD::SetSource</a></div><div class="ttdeci">void SetSource()</div><div class="ttdoc">Define the source term function.</div><div class="ttdef"><b>Definition</b> <a href="20incrementalPOD_8C_source.html#l00095">20incrementalPOD.C:95</a></div></div>
<div class="line">        {</div>
<div class="line">            volScalarField <a class="code hl_variable" href="tutorials_2CFD_202thermalBlock_2createFields_8H.html#ac6e67e5edf79588b4d199f5f1c124b29">yPos</a> = <a class="code hl_variable" href="createT_8H.html#ab35c96e5601691f7270cfadc745a12d3">T</a>.mesh().C().component(vector::Y).ref();</div>
<div class="line">            volScalarField <a class="code hl_variable" href="tutorials_2CFD_202thermalBlock_2createFields_8H.html#a1270eea4f90e7d2a7bf7fd356be6cb14">xPos</a> = <a class="code hl_variable" href="createT_8H.html#ab35c96e5601691f7270cfadc745a12d3">T</a>.mesh().C().component(vector::X).ref();</div>
<div class="line">            <a id="a21" name="a21"></a><a class="code hl_function" href="CGtest_8H.html#a4c72ffa8864003fbe268c530225cac3e">forAll</a>(<a class="code hl_function" href="tutorials_2CFD_202thermalBlock_2createFields_8H.html#ae819a68dfc4ab3fb8011ad652efb475b">S</a>, <a id="a22" name="a22"></a><a class="code hl_variable" href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">counter</a>)</div>
<div class="line">            {</div>
<div class="line">                <a class="code hl_function" href="tutorials_2CFD_202thermalBlock_2createFields_8H.html#ae819a68dfc4ab3fb8011ad652efb475b">S</a>[<a class="code hl_variable" href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">counter</a>] = Foam::sin(<a class="code hl_variable" href="tutorials_2CFD_202thermalBlock_2createFields_8H.html#a1270eea4f90e7d2a7bf7fd356be6cb14">xPos</a>[<a class="code hl_variable" href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">counter</a>] / 0.9 * M_PI) + Foam::sin(</div>
<div class="line">                                 <a class="code hl_variable" href="tutorials_2CFD_202thermalBlock_2createFields_8H.html#ac6e67e5edf79588b4d199f5f1c124b29">yPos</a>[<a class="code hl_variable" href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">counter</a>] / 0.9 * M_PI);</div>
<div class="line">            }</div>
<div class="ttc" id="aCGtest_8H_html_a4c72ffa8864003fbe268c530225cac3e"><div class="ttname"><a href="CGtest_8H.html#a4c72ffa8864003fbe268c530225cac3e">forAll</a></div><div class="ttdeci">forAll(example_CG.gList, solutionI)</div><div class="ttdef"><b>Definition</b> <a href="CGtest_8H_source.html#l00021">CGtest.H:21</a></div></div>
<div class="ttc" id="aclassreductionProblem_html_a5614ff6de814707075dba94edcd48c5e"><div class="ttname"><a href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">reductionProblem::counter</a></div><div class="ttdeci">label counter</div><div class="ttdoc">Counter used for the output of the full order solutions.</div><div class="ttdef"><b>Definition</b> <a href="reductionProblem_8H_source.html#l00110">reductionProblem.H:110</a></div></div>
<div class="ttc" id="atutorials_2CFD_202thermalBlock_2createFields_8H_html_a1270eea4f90e7d2a7bf7fd356be6cb14"><div class="ttname"><a href="tutorials_2CFD_202thermalBlock_2createFields_8H.html#a1270eea4f90e7d2a7bf7fd356be6cb14">xPos</a></div><div class="ttdeci">volScalarField xPos</div><div class="ttdef"><b>Definition</b> <a href="tutorials_2CFD_202thermalBlock_2createFields_8H_source.html#l00038">createFields.H:38</a></div></div>
<div class="ttc" id="atutorials_2CFD_202thermalBlock_2createFields_8H_html_ac6e67e5edf79588b4d199f5f1c124b29"><div class="ttname"><a href="tutorials_2CFD_202thermalBlock_2createFields_8H.html#ac6e67e5edf79588b4d199f5f1c124b29">yPos</a></div><div class="ttdeci">volScalarField yPos</div><div class="ttdef"><b>Definition</b> <a href="tutorials_2CFD_202thermalBlock_2createFields_8H_source.html#l00037">createFields.H:37</a></div></div>
<div class="line">        }</div>
</div><!-- fragment --><p> Define by:</p>
<p class="formulaDsp">
\[ S = \sin(\frac{\pi}{L}\cdot x) + \sin(\frac{\pi}{L}\cdot y) \]
</p>
<p>where \(L\) is the dimension of the thermal block which is equal to 0.9.</p>
<div class="image">
<img src="hat.jpg" alt=""/>
</div>
<p>With the following is defined a method to set compute the parameter of the affine expansion:</p>
<div class="fragment"><div class="line">        <span class="keywordtype">void</span> <a id="a23" name="a23"></a><a class="code hl_function" href="classtutorialIPOD.html#a1d7e359cc7edfcc3ff8e26fee1306ace">compute_nu</a>()</div>
<div class="ttc" id="aclasstutorialIPOD_html_a1d7e359cc7edfcc3ff8e26fee1306ace"><div class="ttname"><a href="classtutorialIPOD.html#a1d7e359cc7edfcc3ff8e26fee1306ace">tutorialIPOD::compute_nu</a></div><div class="ttdeci">void compute_nu()</div><div class="ttdoc">Compute the diffusivity in each subdomain.</div><div class="ttdef"><b>Definition</b> <a href="20incrementalPOD_8C_source.html#l00107">20incrementalPOD.C:107</a></div></div>
<div class="line">        {</div>
</div><!-- fragment --><p> The list of parameters is resized according to number of parametrized regions </p><div class="fragment"><div class="line">            <a id="a24" name="a24"></a><a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.resize(9);</div>
<div class="ttc" id="aclasslaplacianProblem_html_a260a78178e7237e44981a07b84b9b9b3"><div class="ttname"><a href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">laplacianProblem::nu_list</a></div><div class="ttdeci">PtrList&lt; volScalarField &gt; nu_list</div><div class="ttdoc">Nu (diffusivity)</div><div class="ttdef"><b>Definition</b> <a href="laplacianProblem_8H_source.html#l00077">laplacianProblem.H:77</a></div></div>
</div><!-- fragment --><p> The nine different volScalarFields to identify the viscosity in each domain are initialized:</p>
<div class="fragment"><div class="line">            volScalarField nu1(<a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>);</div>
<div class="line">            volScalarField nu2(<a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>);</div>
<div class="line">            volScalarField nu3(<a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>);</div>
<div class="line">            volScalarField nu4(<a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>);</div>
<div class="line">            volScalarField nu5(<a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>);</div>
<div class="line">            volScalarField nu6(<a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>);</div>
<div class="line">            volScalarField nu7(<a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>);</div>
<div class="line">            volScalarField nu8(<a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>);</div>
<div class="line">            volScalarField nu9(<a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>);</div>
</div><!-- fragment --><p> and the 9 different boxes are defined:</p>
<div class="fragment"><div class="line">            Eigen::MatrixXd Box1(2, 3);</div>
<div class="line">            Box1 &lt;&lt; 0, 0, 0, 0.3, 0.3, 0.1;</div>
<div class="line">            Eigen::MatrixXd Box2(2, 3);</div>
<div class="line">            Box2 &lt;&lt; 0.3, 0, 0, 0.6, 0.3, 0.1;</div>
<div class="line">            Eigen::MatrixXd Box3(2, 3);</div>
<div class="line">            Box3 &lt;&lt; 0.6, 0, 0, 0.91, 0.3, 0.1;</div>
<div class="line">            Eigen::MatrixXd Box4(2, 3);</div>
<div class="line">            Box4 &lt;&lt; 0, 0.3, 0, 0.3, 0.6, 0.1;</div>
<div class="line">            Eigen::MatrixXd Box5(2, 3);</div>
<div class="line">            Box5 &lt;&lt; 0.3, 0.3, 0, 0.6, 0.6, 0.1;</div>
<div class="line">            Eigen::MatrixXd Box6(2, 3);</div>
<div class="line">            Box6 &lt;&lt; 0.6, 0.3, 0, 0.91, 0.6, 0.1;</div>
<div class="line">            Eigen::MatrixXd Box7(2, 3);</div>
<div class="line">            Box7 &lt;&lt; 0, 0.6, 0, 0.3, 0.91, 0.1;</div>
<div class="line">            Eigen::MatrixXd Box8(2, 3);</div>
<div class="line">            Box8 &lt;&lt; 0.3, 0.61, 0, 0.6, 0.91, 0.1;</div>
<div class="line">            Eigen::MatrixXd Box9(2, 3);</div>
</div><!-- fragment --><p> and for each of the defined boxes the relative diffusivity field is set to 1 inside the box and remain 0 elsewhere:</p>
<div class="fragment"><div class="line">            <a id="a25" name="a25"></a><a class="code hl_function" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a>(nu1, Box1, 1.0);</div>
<div class="ttc" id="anamespaceITHACAutilities_html_afe130b8e3e00ec1ab84026ae867f92cb"><div class="ttname"><a href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a></div><div class="ttdeci">void setBoxToValue(GeometricField&lt; Type, fvPatchField, volMesh &gt; &amp;field, Eigen::MatrixXd Box, Type value)</div><div class="ttdoc">Set value of a volScalarField to a constant inside a given box.</div><div class="ttdef"><b>Definition</b> <a href="ITHACAassign_8C_source.html#l00618">ITHACAassign.C:618</a></div></div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a>(nu2, Box2, 1.0);</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a>(nu3, Box3, 1.0);</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a>(nu4, Box4, 1.0);</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a>(nu5, Box5, 1.0);</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a>(nu6, Box6, 1.0);</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a>(nu7, Box7, 1.0);</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a>(nu8, Box8, 1.0);</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a>(nu9, Box9, 1.0);</div>
</div><!-- fragment --><p> See also the <a class="el" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb" title="Set value of a volScalarField to a constant inside a given box.">ITHACAutilities::setBoxToValue</a> for more details.</p>
<p>The list of diffusivity fields is set with:</p>
<div class="fragment"><div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.set(0, (nu1).clone());</div>
<div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.set(1, (nu2).clone());</div>
<div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.set(2, (nu3).clone());</div>
<div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.set(3, (nu4).clone());</div>
<div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.set(4, (nu5).clone());</div>
<div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.set(5, (nu6).clone());</div>
<div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.set(6, (nu7).clone());</div>
<div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.set(7, (nu8).clone());</div>
<div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.set(8, (nu9).clone());</div>
<div class="line">        }</div>
</div><!-- fragment --> <h2><a class="anchor" id="main"></a>
Definition of the main function</h2>
<p>Once the <a class="el" href="classtutorialIPOD.html" title="Class where the tutorial number 20 is implemented.">tutorialIPOD</a> class is defined the main function is defined, an example of type <a class="el" href="classtutorialIPOD.html" title="Class where the tutorial number 20 is implemented.">tutorialIPOD</a> is constructed:</p>
<div class="fragment"><div class="line">    <a class="code hl_class" href="classtutorialIPOD.html">tutorialIPOD</a> example(argc, argv);</div>
</div><!-- fragment --><p> the number of parameter is set:</p>
<div class="fragment"><div class="line">    example.Pnumber = 9;</div>
<div class="line">    example.setParameters();</div>
</div><!-- fragment --><p> the range of the parameters is defined:</p>
<div class="fragment"><div class="line">    example.mu_range.col(0) = Eigen::MatrixXd::Ones(9, 1) * 0.001;</div>
<div class="line">    example.mu_range.col(1) = Eigen::MatrixXd::Ones(9, 1) * 0.1;</div>
</div><!-- fragment --><p> and 500 random combinations of the parameters are generated:</p>
<div class="fragment"><div class="line">    example.genRandPar(example.Tnumber);</div>
</div><!-- fragment --><p> the size of the list of values that are multiplying the affine forms is set:</p>
<div class="fragment"><div class="line">    example.theta.resize(9);</div>
</div><!-- fragment --><p> the source term is defined, the compute_nu and assemble_operator functions are called</p>
<div class="fragment"><div class="line">    example.SetSource();</div>
<div class="line">    example.compute_nu();</div>
<div class="line">    example.assemble_operator();</div>
</div><!-- fragment --><p> then the Offline full order Solve is performed:</p>
<div class="fragment"><div class="line">    example.offlineSolve();</div>
</div><!-- fragment --><p> Once the Offline solve is performed the modes ar obtained using the <a class="el" href="namespaceITHACAPOD.html#aa66f8357143947aa1c3359627eeb0ddd" title="Computes the bases or reads them for a field.">ITHACAPOD::getModes</a> function:</p>
<div class="fragment"><div class="line">    <a id="a26" name="a26"></a><a class="code hl_function" href="namespaceITHACAPOD.html#aa66f8357143947aa1c3359627eeb0ddd">ITHACAPOD::getModes</a>(example.Tfield, example.Tmodes, example._T().name(),</div>
<div class="ttc" id="anamespaceITHACAPOD_html_aa66f8357143947aa1c3359627eeb0ddd"><div class="ttname"><a href="namespaceITHACAPOD.html#aa66f8357143947aa1c3359627eeb0ddd">ITHACAPOD::getModes</a></div><div class="ttdeci">void getModes(PtrList&lt; GeometricField&lt; Type, PatchField, GeoMesh &gt; &gt; &amp;snapshots, PtrList&lt; GeometricField&lt; Type, PatchField, GeoMesh &gt; &gt; &amp;modes, word fieldName, bool podex, bool supex, bool sup, label nmodes, bool correctBC)</div><div class="ttdoc">Computes the bases or reads them for a field.</div><div class="ttdef"><b>Definition</b> <a href="ITHACAPOD_8C_source.html#l00090">ITHACAPOD.C:90</a></div></div>
</div><!-- fragment --><p> Then, the incremental POD is initialized</p>
<div class="fragment"><div class="line">    <a class="code hl_typedef" href="incrementalPOD_8H.html#afb805e76f79b99fb6a06ab3e37922e62">scalarIncrementalPOD</a> IPOD(example.Tfield[0], tolleranceSVD, <span class="stringliteral">&quot;L2&quot;</span>);</div>
<div class="ttc" id="aincrementalPOD_8H_html_afb805e76f79b99fb6a06ab3e37922e62"><div class="ttname"><a href="incrementalPOD_8H.html#afb805e76f79b99fb6a06ab3e37922e62">scalarIncrementalPOD</a></div><div class="ttdeci">incrementalPOD&lt; scalar, fvPatchField, volMesh &gt; scalarIncrementalPOD</div><div class="ttdef"><b>Definition</b> <a href="incrementalPOD_8H_source.html#l00179">incrementalPOD.H:179</a></div></div>
</div><!-- fragment --><p> and filled</p>
<div class="fragment"><div class="line"></div>
<div class="line"></div>
</div><!-- fragment --><p> Finally, we do some post processing</p>
<h1><a class="anchor" id="plaincode"></a>
The plain program</h1>
<p>Here there's the plain code</p>
<div class="fragment"><div class="line"><span class="comment">/*---------------------------------------------------------------------------*\</span></div>
<div class="line"><span class="comment">     ██╗████████╗██╗  ██╗ █████╗  ██████╗ █████╗       ███████╗██╗   ██╗</span></div>
<div class="line"><span class="comment">     ██║╚══██╔══╝██║  ██║██╔══██╗██╔════╝██╔══██╗      ██╔════╝██║   ██║</span></div>
<div class="line"><span class="comment">     ██║   ██║   ███████║███████║██║     ███████║█████╗█████╗  ██║   ██║</span></div>
<div class="line"><span class="comment">     ██║   ██║   ██╔══██║██╔══██║██║     ██╔══██║╚════╝██╔══╝  ╚██╗ ██╔╝</span></div>
<div class="line"><span class="comment">     ██║   ██║   ██║  ██║██║  ██║╚██████╗██║  ██║      ██║      ╚████╔╝</span></div>
<div class="line"><span class="comment">     ╚═╝   ╚═╝   ╚═╝  ╚═╝╚═╝  ╚═╝ ╚═════╝╚═╝  ╚═╝      ╚═╝       ╚═══╝</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> * In real Time Highly Advanced Computational Applications for Finite Volumes</span></div>
<div class="line"><span class="comment"> * Copyright (C) 2017 by the ITHACA-FV authors</span></div>
<div class="line"><span class="comment">-------------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment">License</span></div>
<div class="line"><span class="comment">    This file is part of ITHACA-FV</span></div>
<div class="line"><span class="comment">    ITHACA-FV is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment">    it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><span class="comment">    the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment">    (at your option) any later version.</span></div>
<div class="line"><span class="comment">    ITHACA-FV is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div>
<div class="line"><span class="comment">    GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment">    You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment">    along with ITHACA-FV. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment">Description</span></div>
<div class="line"><span class="comment">    Example of a heat transfer Reduction Problem</span></div>
<div class="line"><span class="comment">SourceFiles</span></div>
<div class="line"><span class="comment">    20incrementalPOD.C</span></div>
<div class="line"><span class="comment">\*---------------------------------------------------------------------------*/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;fvCFD.H&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;IOmanip.H&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;Time.H&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="laplacianProblem_8H.html">laplacianProblem.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ReducedLaplacian_8H.html">ReducedLaplacian.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ITHACAPOD_8H.html">ITHACAPOD.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ITHACAutilities_8H.html">ITHACAutilities.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="incrementalPOD_8H.html">incrementalPOD.H</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Eigen/Dense&gt;</span></div>
<div class="line"><span class="preprocessor">#define _USE_MATH_DEFINES</span></div>
<div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classtutorialIPOD.html">tutorialIPOD</a>: <span class="keyword">public</span> <a class="code hl_class" href="classlaplacianProblem.html">laplacianProblem</a></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        <span class="keyword">explicit</span> <a class="code hl_function" href="classtutorialIPOD.html#a0eef636c08215037ea95e6e788a2595a">tutorialIPOD</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">            :</div>
<div class="line">            <a class="code hl_function" href="classlaplacianProblem.html#a7b70e752393c730c39ff25c4fb0ddbec">laplacianProblem</a>(argc, argv),</div>
<div class="line">            <a id="a27" name="a27"></a><a class="code hl_variable" href="classtutorialIPOD.html#ac1fcd8f3c388221cdca47e5a5db3e4f4">T</a>(<a id="a28" name="a28"></a><a class="code hl_variable" href="classlaplacianProblem.html#a7367f8517a5a9f7097c82bbf97eda7d4">_T</a>()),</div>
<div class="line">            <a id="a29" name="a29"></a><a class="code hl_variable" href="classtutorialIPOD.html#a6bb58d37bc00979285ab5d419009307b">nu</a>(<a id="a30" name="a30"></a><a class="code hl_variable" href="classlaplacianProblem.html#a9b080f4e8cfe2198d77eb9dedb384032">_nu</a>()),</div>
<div class="line">            <a id="a31" name="a31"></a><a class="code hl_variable" href="classtutorialIPOD.html#a2bb0f65d3a4cbc20cdb90b8d11fabfec">S</a>(<a id="a32" name="a32"></a><a class="code hl_variable" href="classlaplacianProblem.html#ac99b6f6820ca07d4fd81e2a7b413cec2">_S</a>())</div>
<div class="line">        {}</div>
<div class="line"></div>
<div class="line">        volScalarField&amp; <a class="code hl_variable" href="createT_8H.html#ab35c96e5601691f7270cfadc745a12d3">T</a>;</div>
<div class="line">        volScalarField&amp; <a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>;</div>
<div class="line">        volScalarField&amp; <a class="code hl_function" href="tutorials_2CFD_202thermalBlock_2createFields_8H.html#ae819a68dfc4ab3fb8011ad652efb475b">S</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">void</span> <a class="code hl_function" href="classtutorialIPOD.html#af2e03379a7e6508fcfadc6d8457194b1">offlineSolve</a>(word folder = <span class="stringliteral">&quot;./ITHACAoutput/Offline/&quot;</span>)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classreductionProblem.html#a752b5e2d6094c1ee18da4850443f1617">offline</a>)</div>
<div class="line">            {</div>
<div class="line">                <a class="code hl_function" href="namespaceITHACAstream.html#aa552d7dbbbd8f204bbf55b07836da550">ITHACAstream::read_fields</a>(<a class="code hl_variable" href="classlaplacianProblem.html#ad79501e2e6be69c1846b01d62dd8328a">Tfield</a>, <span class="stringliteral">&quot;T&quot;</span>, folder);</div>
<div class="line">                <a class="code hl_variable" href="classreductionProblem.html#a30a31093d96229e8a53c26d26dbf96c1">mu_samples</a> =</div>
<div class="line">                    <a class="code hl_function" href="namespaceITHACAstream.html#aa259fffbddd2f4a42cc3a4a76f839ef6">ITHACAstream::readMatrix</a>(folder + <span class="stringliteral">&quot;/mu_samples_mat.txt&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                List&lt;scalar&gt; mu_now(9);</div>
<div class="line">                scalar IF = 0;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (label <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> = 0; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> &lt; <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>.rows(); <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>++)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordflow">for</span> (label j = 0; j &lt; <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>.cols() ; j++)</div>
<div class="line">                    {</div>
<div class="line">                        mu_now[j] = <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>, j);</div>
<div class="line">                        <a class="code hl_variable" href="classlaplacianProblem.html#a43d9eb706296997b1cf876423e044fb3">theta</a>[j] = <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>(<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>, j);</div>
<div class="line">                    }</div>
<div class="line"> </div>
<div class="line">                    <a class="code hl_function" href="classreductionProblem.html#a5c9c99f98e576423c196093a72e2ce98">assignIF</a>(<a class="code hl_variable" href="createT_8H.html#ab35c96e5601691f7270cfadc745a12d3">T</a>, IF);</div>
<div class="line">                    Info &lt;&lt; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> &lt;&lt; endl;</div>
<div class="line">                    <a class="code hl_function" href="classreductionProblem.html#aeab985e1958591a9de375c415c8d5e8d">truthSolve</a>(mu_now, folder);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">void</span> <a class="code hl_function" href="classtutorialIPOD.html#a78108e74dc4e17a624e30b779834df81">SetSource</a>()</div>
<div class="line">        {</div>
<div class="line">            volScalarField <a class="code hl_variable" href="tutorials_2CFD_202thermalBlock_2createFields_8H.html#ac6e67e5edf79588b4d199f5f1c124b29">yPos</a> = <a class="code hl_variable" href="createT_8H.html#ab35c96e5601691f7270cfadc745a12d3">T</a>.mesh().C().component(vector::Y).ref();</div>
<div class="line">            volScalarField <a class="code hl_variable" href="tutorials_2CFD_202thermalBlock_2createFields_8H.html#a1270eea4f90e7d2a7bf7fd356be6cb14">xPos</a> = <a class="code hl_variable" href="createT_8H.html#ab35c96e5601691f7270cfadc745a12d3">T</a>.mesh().C().component(vector::X).ref();</div>
<div class="line">            <a class="code hl_function" href="CGtest_8H.html#a4c72ffa8864003fbe268c530225cac3e">forAll</a>(<a class="code hl_function" href="tutorials_2CFD_202thermalBlock_2createFields_8H.html#ae819a68dfc4ab3fb8011ad652efb475b">S</a>, <a class="code hl_variable" href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">counter</a>)</div>
<div class="line">            {</div>
<div class="line">                <a class="code hl_function" href="tutorials_2CFD_202thermalBlock_2createFields_8H.html#ae819a68dfc4ab3fb8011ad652efb475b">S</a>[<a class="code hl_variable" href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">counter</a>] = Foam::sin(<a class="code hl_variable" href="tutorials_2CFD_202thermalBlock_2createFields_8H.html#a1270eea4f90e7d2a7bf7fd356be6cb14">xPos</a>[<a class="code hl_variable" href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">counter</a>] / 0.9 * M_PI) + Foam::sin(</div>
<div class="line">                                 <a class="code hl_variable" href="tutorials_2CFD_202thermalBlock_2createFields_8H.html#ac6e67e5edf79588b4d199f5f1c124b29">yPos</a>[<a class="code hl_variable" href="classreductionProblem.html#a5614ff6de814707075dba94edcd48c5e">counter</a>] / 0.9 * M_PI);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">void</span> <a class="code hl_function" href="classtutorialIPOD.html#a1d7e359cc7edfcc3ff8e26fee1306ace">compute_nu</a>()</div>
<div class="line">        {</div>
<div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.resize(9);</div>
<div class="line">            volScalarField nu1(<a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>);</div>
<div class="line">            volScalarField nu2(<a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>);</div>
<div class="line">            volScalarField nu3(<a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>);</div>
<div class="line">            volScalarField nu4(<a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>);</div>
<div class="line">            volScalarField nu5(<a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>);</div>
<div class="line">            volScalarField nu6(<a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>);</div>
<div class="line">            volScalarField nu7(<a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>);</div>
<div class="line">            volScalarField nu8(<a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>);</div>
<div class="line">            volScalarField nu9(<a class="code hl_variable" href="msrProblem_2readConstants_8H.html#a5b3df2ebbeca3bd7027c0ceb96a997e0">nu</a>);</div>
<div class="line">            Eigen::MatrixXd Box1(2, 3);</div>
<div class="line">            Box1 &lt;&lt; 0, 0, 0, 0.3, 0.3, 0.1;</div>
<div class="line">            Eigen::MatrixXd Box2(2, 3);</div>
<div class="line">            Box2 &lt;&lt; 0.3, 0, 0, 0.6, 0.3, 0.1;</div>
<div class="line">            Eigen::MatrixXd Box3(2, 3);</div>
<div class="line">            Box3 &lt;&lt; 0.6, 0, 0, 0.91, 0.3, 0.1;</div>
<div class="line">            Eigen::MatrixXd Box4(2, 3);</div>
<div class="line">            Box4 &lt;&lt; 0, 0.3, 0, 0.3, 0.6, 0.1;</div>
<div class="line">            Eigen::MatrixXd Box5(2, 3);</div>
<div class="line">            Box5 &lt;&lt; 0.3, 0.3, 0, 0.6, 0.6, 0.1;</div>
<div class="line">            Eigen::MatrixXd Box6(2, 3);</div>
<div class="line">            Box6 &lt;&lt; 0.6, 0.3, 0, 0.91, 0.6, 0.1;</div>
<div class="line">            Eigen::MatrixXd Box7(2, 3);</div>
<div class="line">            Box7 &lt;&lt; 0, 0.6, 0, 0.3, 0.91, 0.1;</div>
<div class="line">            Eigen::MatrixXd Box8(2, 3);</div>
<div class="line">            Box8 &lt;&lt; 0.3, 0.61, 0, 0.6, 0.91, 0.1;</div>
<div class="line">            Eigen::MatrixXd Box9(2, 3);</div>
<div class="line">            Box9 &lt;&lt; 0.6, 0.6, 0, 0.9, 0.91, 0.1;</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a>(nu1, Box1, 1.0);</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a>(nu2, Box2, 1.0);</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a>(nu3, Box3, 1.0);</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a>(nu4, Box4, 1.0);</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a>(nu5, Box5, 1.0);</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a>(nu6, Box6, 1.0);</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a>(nu7, Box7, 1.0);</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a>(nu8, Box8, 1.0);</div>
<div class="line">            <a class="code hl_function" href="namespaceITHACAutilities.html#afe130b8e3e00ec1ab84026ae867f92cb">ITHACAutilities::setBoxToValue</a>(nu9, Box9, 1.0);</div>
<div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.set(0, (nu1).clone());</div>
<div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.set(1, (nu2).clone());</div>
<div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.set(2, (nu3).clone());</div>
<div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.set(3, (nu4).clone());</div>
<div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.set(4, (nu5).clone());</div>
<div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.set(5, (nu6).clone());</div>
<div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.set(6, (nu7).clone());</div>
<div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.set(7, (nu8).clone());</div>
<div class="line">            <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.set(8, (nu9).clone());</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">void</span> <a id="a33" name="a33"></a><a class="code hl_function" href="classtutorialIPOD.html#adf9f1d60709f70f738037fdcc063610d">assemble_operator</a>()</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> = 0; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> &lt; <a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>.size(); <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>++)</div>
<div class="line">            {</div>
<div class="line">                <a id="a34" name="a34"></a><a class="code hl_variable" href="classlaplacianProblem.html#a5d4f69f6a52cee59791fa9a3fcb4d159">operator_list</a>.append(fvm::laplacian(<a class="code hl_variable" href="classlaplacianProblem.html#a260a78178e7237e44981a07b84b9b9b3">nu_list</a>[<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>], <a class="code hl_variable" href="createT_8H.html#ab35c96e5601691f7270cfadc745a12d3">T</a>));</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        volScalarField <a id="a35" name="a35"></a><a class="code hl_function" href="classtutorialIPOD.html#ad53d83fbbb1965469f13f1368ded1545">solveFull</a>(<span class="keywordtype">double</span> _mu)</div>
<div class="line">        {</div>
<div class="line">            word folder = <span class="stringliteral">&quot;./ITHACAoutput/test/&quot;</span>;</div>
<div class="line">            scalar IF = 0;</div>
<div class="line">            List&lt;scalar&gt; mu_now(9);</div>
<div class="line">            volScalarField&amp; <a class="code hl_variable" href="createT_8H.html#ab35c96e5601691f7270cfadc745a12d3">T</a> = <a class="code hl_variable" href="classlaplacianProblem.html#a7367f8517a5a9f7097c82bbf97eda7d4">_T</a>();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (label j = 0; j &lt; <a class="code hl_variable" href="classreductionProblem.html#acca797c9e7595c83d45d40c286b9a6ee">mu</a>.cols() ; j++)</div>
<div class="line">            {</div>
<div class="line">                mu_now[j] = _mu;</div>
<div class="line">                <a class="code hl_variable" href="classlaplacianProblem.html#a43d9eb706296997b1cf876423e044fb3">theta</a>[j] = _mu;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_function" href="classreductionProblem.html#a5c9c99f98e576423c196093a72e2ce98">assignIF</a>(<a class="code hl_variable" href="createT_8H.html#ab35c96e5601691f7270cfadc745a12d3">T</a>, IF);</div>
<div class="line">            <a class="code hl_function" href="classreductionProblem.html#aeab985e1958591a9de375c415c8d5e8d">truthSolve</a>(mu_now, folder);</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code hl_variable" href="createT_8H.html#ab35c96e5601691f7270cfadc745a12d3">T</a>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a id="a36" name="a36"></a><a class="code hl_function" href="extract__time__evolution_8C.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Create the example object of the tutorialIPOD type</span></div>
<div class="line">    <a class="code hl_class" href="classtutorialIPOD.html">tutorialIPOD</a> example(argc, argv);</div>
<div class="line">    <span class="comment">// Read some parameters from file</span></div>
<div class="line">    <a id="_a37" name="_a37"></a><a class="code hl_class" href="classITHACAparameters.html">ITHACAparameters</a>* <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a> = <a id="a38" name="a38"></a><a class="code hl_function" href="classITHACAparameters.html#adf4e7e15954b8779d57ed6478a19027f">ITHACAparameters::getInstance</a>(example._mesh(),</div>
<div class="line">                             example._runTime());</div>
<div class="line">    <span class="keywordtype">int</span> NmodesTout = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesTout&quot;</span>, 15);</div>
<div class="line">    <span class="keywordtype">int</span> NmodesTproj = <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;NmodesTproj&quot;</span>, 10);</div>
<div class="line">    <span class="keywordtype">double</span> tolleranceSVD =</div>
<div class="line">        <a class="code hl_variable" href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a>-&gt;ITHACAdict-&gt;lookupOrDefault&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;tolleranceSVD&quot;</span>, 1);</div>
<div class="line">    <span class="comment">// Set the number of parameters</span></div>
<div class="line">    example.Pnumber = 9;</div>
<div class="line">    example.Tnumber = NmodesTout;</div>
<div class="line">    <span class="comment">// Set the parameters</span></div>
<div class="line">    example.setParameters();</div>
<div class="line">    <span class="comment">// Set the parameter ranges, in all the subdomains the diffusivity varies between</span></div>
<div class="line">    <span class="comment">// 0.001 and 0.1</span></div>
<div class="line">    example.mu_range.col(0) = Eigen::MatrixXd::Ones(9, 1) * 0.001;</div>
<div class="line">    example.mu_range.col(1) = Eigen::MatrixXd::Ones(9, 1) * 0.1;</div>
<div class="line">    <span class="comment">// Generate the Parameters</span></div>
<div class="line">    example.genRandPar(example.Tnumber);</div>
<div class="line">    <span class="comment">// Set the size of the list of values that are multiplying the affine forms</span></div>
<div class="line">    example.theta.resize(9);</div>
<div class="line">    <span class="comment">// Set the source term</span></div>
<div class="line">    example.SetSource();</div>
<div class="line">    <span class="comment">// Compute the diffusivity field for each subdomain</span></div>
<div class="line">    example.compute_nu();</div>
<div class="line">    <span class="comment">// Assemble all the operators of the affine decomposition</span></div>
<div class="line">    example.assemble_operator();</div>
<div class="line">    <span class="comment">// Perform an Offline Solve</span></div>
<div class="line">    example.offlineSolve();</div>
<div class="line">    <span class="comment">// Perform a POD decomposition and get the modes</span></div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAPOD.html#aa66f8357143947aa1c3359627eeb0ddd">ITHACAPOD::getModes</a>(example.Tfield, example.Tmodes, example._T().name(),</div>
<div class="line">                        example.podex, 0, 0,</div>
<div class="line">                        NmodesTout);</div>
<div class="line">    <span class="comment">// Set up the incremental POD space</span></div>
<div class="line">    <a class="code hl_typedef" href="incrementalPOD_8H.html#afb805e76f79b99fb6a06ab3e37922e62">scalarIncrementalPOD</a> IPOD(example.Tfield[0], tolleranceSVD, <span class="stringliteral">&quot;L2&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Fill the incremental POD space</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fieldI = 1; fieldI &lt; example.Tfield.size(); fieldI++)</div>
<div class="line">    {</div>
<div class="line">        IPOD.addSnapshot(example.Tfield[fieldI]);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    IPOD.writeModes();</div>
<div class="line">    <span class="comment">// Post processing</span></div>
<div class="line">    word folder = <span class="stringliteral">&quot;./ITHACAoutput/testReconstruction&quot;</span>;</div>
<div class="line">    <span class="comment">// Compute new full order solution</span></div>
<div class="line">    volScalarField Tfull(example.solveFull(0.05));</div>
<div class="line">    PtrList&lt;volScalarField&gt; TfullList;</div>
<div class="line">    TfullList.append(Tfull.clone());</div>
<div class="line">    PtrList&lt;volScalarField&gt; Tproj;</div>
<div class="line">    <span class="comment">// Project the full order solution onto the POD space</span></div>
<div class="line">    example.Tmodes.projectSnapshots(TfullList, Tproj, NmodesTproj);</div>
<div class="line">    <a id="a39" name="a39"></a><a class="code hl_function" href="namespaceITHACAstream.html#a36ae0d53d94f890fdfe72086003eacee">ITHACAstream::exportSolution</a>(Tfull, <span class="stringliteral">&quot;1&quot;</span>, folder, <span class="stringliteral">&quot;Tfull&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a36ae0d53d94f890fdfe72086003eacee">ITHACAstream::exportSolution</a>(Tproj[0], <span class="stringliteral">&quot;1&quot;</span>, folder, <span class="stringliteral">&quot;Tpod&quot;</span>);</div>
<div class="line">    <span class="comment">// Compute the relative error between POD projected field and full order snapshot</span></div>
<div class="line">    <span class="keywordtype">double</span> EPS = 1e-16;</div>
<div class="line">    volScalarField relativeErrorField(Tproj[0]);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (label <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> = 0; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> &lt; relativeErrorField.internalField().size(); <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (std::abs(Tfull.ref()[<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]) &lt; EPS)</div>
<div class="line">        {</div>
<div class="line">            relativeErrorField.ref()[<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>] = (std::abs(Tfull.ref()[<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>] - Tproj[0].ref()[<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>])) /</div>
<div class="line">                                          EPS;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            relativeErrorField.ref()[<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>] = (std::abs(Tfull.ref()[<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>] - Tproj[0].ref()[<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>])) /</div>
<div class="line">                                          Tfull.ref()[<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>];</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a36ae0d53d94f890fdfe72086003eacee">ITHACAstream::exportSolution</a>(relativeErrorField,</div>
<div class="line">                                 <span class="stringliteral">&quot;1&quot;</span>, folder,</div>
<div class="line">                                 <span class="stringliteral">&quot;relativeErrorField_POD&quot;</span>);</div>
<div class="line">    Info &lt;&lt; <span class="stringliteral">&quot;Relative error L2 norm POD = &quot;</span> &lt;&lt; <a id="a40" name="a40"></a><a class="code hl_function" href="namespaceITHACAutilities.html#a3f31e4b1e850395a67013e9e48f96a27">ITHACAutilities::L2Norm</a>(</div>
<div class="line">             relativeErrorField) &lt;&lt; endl;</div>
<div class="line">    <span class="comment">// Project the full order solution onto the incremental POD space</span></div>
<div class="line">    IPOD.projectSnapshots(TfullList, Tproj);</div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a36ae0d53d94f890fdfe72086003eacee">ITHACAstream::exportSolution</a>(Tproj[0], <span class="stringliteral">&quot;1&quot;</span>, folder, <span class="stringliteral">&quot;Tipod&quot;</span>);</div>
<div class="line">    volScalarField Tipod = Tproj[0];</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Compute the relative error between incremental POD projected field and full order snapshot</span></div>
<div class="line">    <span class="keywordflow">for</span> (label <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> = 0; <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a> &lt; relativeErrorField.internalField().size(); <a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>++)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (std::abs(Tfull.ref()[<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>]) &lt; EPS)</div>
<div class="line">        {</div>
<div class="line">            relativeErrorField.ref()[<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>] = (std::abs(Tfull.ref()[<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>] - Tipod.ref()[<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>])) / EPS;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            relativeErrorField.ref()[<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>] = (std::abs(Tfull.ref()[<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>] - Tipod.ref()[<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>])) /</div>
<div class="line">                                          Tfull.ref()[<a class="code hl_variable" href="src_2ITHACA__FOMPROBLEMS_2msrProblem_2pEqn_8H.html#ac23c63c7750d8829a77f4ebe1d961c48">i</a>];</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="namespaceITHACAstream.html#a36ae0d53d94f890fdfe72086003eacee">ITHACAstream::exportSolution</a>(relativeErrorField,</div>
<div class="line">                                 <span class="stringliteral">&quot;1&quot;</span>, folder,</div>
<div class="line">                                 <span class="stringliteral">&quot;relativeErrorField_IPOD&quot;</span>);</div>
<div class="line">    Info &lt;&lt; <span class="stringliteral">&quot;\n\nRelative error L2 norm incrementalPOD = &quot;</span> &lt;&lt;</div>
<div class="line">         <a class="code hl_function" href="namespaceITHACAutilities.html#a3f31e4b1e850395a67013e9e48f96a27">ITHACAutilities::L2Norm</a>(relativeErrorField) &lt;&lt; endl;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//--------</span></div>
<div class="line"></div>
<div class="ttc" id="aNLsolve_8H_html_a8fe34eb12dd4c1271bb9123ed6982124"><div class="ttname"><a href="NLsolve_8H.html#a8fe34eb12dd4c1271bb9123ed6982124">para</a></div><div class="ttdeci">ITHACAparameters * para</div><div class="ttdef"><b>Definition</b> <a href="NLsolve_8H_source.html#l00040">NLsolve.H:40</a></div></div>
<div class="ttc" id="aReducedLaplacian_8H_html"><div class="ttname"><a href="ReducedLaplacian_8H.html">ReducedLaplacian.H</a></div><div class="ttdoc">Header file of the reducedLaplacian class.</div></div>
<div class="ttc" id="aclassITHACAparameters_html"><div class="ttname"><a href="classITHACAparameters.html">ITHACAparameters</a></div><div class="ttdoc">Class for the definition of some general parameters, the parameters must be defined from the file ITH...</div><div class="ttdef"><b>Definition</b> <a href="ITHACAparameters_8H_source.html#l00040">ITHACAparameters.H:41</a></div></div>
<div class="ttc" id="aclassITHACAparameters_html_adf4e7e15954b8779d57ed6478a19027f"><div class="ttname"><a href="classITHACAparameters.html#adf4e7e15954b8779d57ed6478a19027f">ITHACAparameters::getInstance</a></div><div class="ttdeci">static ITHACAparameters * getInstance()</div><div class="ttdoc">Gets an instance of ITHACAparameters, to be used if the instance is already existing.</div><div class="ttdef"><b>Definition</b> <a href="ITHACAparameters_8C_source.html#l00056">ITHACAparameters.C:56</a></div></div>
<div class="ttc" id="aclasslaplacianProblem_html_a5d4f69f6a52cee59791fa9a3fcb4d159"><div class="ttname"><a href="classlaplacianProblem.html#a5d4f69f6a52cee59791fa9a3fcb4d159">laplacianProblem::operator_list</a></div><div class="ttdeci">PtrList&lt; fvScalarMatrix &gt; operator_list</div><div class="ttdoc">List of operators.</div><div class="ttdef"><b>Definition</b> <a href="laplacianProblem_8H_source.html#l00071">laplacianProblem.H:71</a></div></div>
<div class="ttc" id="aclasslaplacianProblem_html_a7367f8517a5a9f7097c82bbf97eda7d4"><div class="ttname"><a href="classlaplacianProblem.html#a7367f8517a5a9f7097c82bbf97eda7d4">laplacianProblem::_T</a></div><div class="ttdeci">autoPtr&lt; volScalarField &gt; _T</div><div class="ttdoc">Temperature field.</div><div class="ttdef"><b>Definition</b> <a href="laplacianProblem_8H_source.html#l00090">laplacianProblem.H:90</a></div></div>
<div class="ttc" id="aclasslaplacianProblem_html_a9b080f4e8cfe2198d77eb9dedb384032"><div class="ttname"><a href="classlaplacianProblem.html#a9b080f4e8cfe2198d77eb9dedb384032">laplacianProblem::_nu</a></div><div class="ttdeci">autoPtr&lt; volScalarField &gt; _nu</div><div class="ttdoc">Diffusivity.</div><div class="ttdef"><b>Definition</b> <a href="laplacianProblem_8H_source.html#l00094">laplacianProblem.H:94</a></div></div>
<div class="ttc" id="aclasslaplacianProblem_html_ac99b6f6820ca07d4fd81e2a7b413cec2"><div class="ttname"><a href="classlaplacianProblem.html#ac99b6f6820ca07d4fd81e2a7b413cec2">laplacianProblem::_S</a></div><div class="ttdeci">autoPtr&lt; volScalarField &gt; _S</div><div class="ttdoc">Source Term.</div><div class="ttdef"><b>Definition</b> <a href="laplacianProblem_8H_source.html#l00092">laplacianProblem.H:92</a></div></div>
<div class="ttc" id="aclasstutorialIPOD_html_a2bb0f65d3a4cbc20cdb90b8d11fabfec"><div class="ttname"><a href="classtutorialIPOD.html#a2bb0f65d3a4cbc20cdb90b8d11fabfec">tutorialIPOD::S</a></div><div class="ttdeci">volScalarField &amp; S</div><div class="ttdoc">Source term field.</div><div class="ttdef"><b>Definition</b> <a href="20incrementalPOD_8C_source.html#l00063">20incrementalPOD.C:63</a></div></div>
<div class="ttc" id="aclasstutorialIPOD_html_a6bb58d37bc00979285ab5d419009307b"><div class="ttname"><a href="classtutorialIPOD.html#a6bb58d37bc00979285ab5d419009307b">tutorialIPOD::nu</a></div><div class="ttdeci">volScalarField &amp; nu</div><div class="ttdoc">Diffusivity field.</div><div class="ttdef"><b>Definition</b> <a href="20incrementalPOD_8C_source.html#l00061">20incrementalPOD.C:61</a></div></div>
<div class="ttc" id="aclasstutorialIPOD_html_ac1fcd8f3c388221cdca47e5a5db3e4f4"><div class="ttname"><a href="classtutorialIPOD.html#ac1fcd8f3c388221cdca47e5a5db3e4f4">tutorialIPOD::T</a></div><div class="ttdeci">volScalarField &amp; T</div><div class="ttdoc">[tutorialIPOD] Temperature field</div><div class="ttdef"><b>Definition</b> <a href="20incrementalPOD_8C_source.html#l00059">20incrementalPOD.C:59</a></div></div>
<div class="ttc" id="aclasstutorialIPOD_html_ad53d83fbbb1965469f13f1368ded1545"><div class="ttname"><a href="classtutorialIPOD.html#ad53d83fbbb1965469f13f1368ded1545">tutorialIPOD::solveFull</a></div><div class="ttdeci">volScalarField solveFull(double _mu)</div><div class="ttdoc">Performs a full order solution for a uniform value of mu.</div><div class="ttdef"><b>Definition</b> <a href="20incrementalPOD_8C_source.html#l00167">20incrementalPOD.C:167</a></div></div>
<div class="ttc" id="aclasstutorialIPOD_html_adf9f1d60709f70f738037fdcc063610d"><div class="ttname"><a href="classtutorialIPOD.html#adf9f1d60709f70f738037fdcc063610d">tutorialIPOD::assemble_operator</a></div><div class="ttdeci">void assemble_operator()</div><div class="ttdoc">Construct the operator_list where each term of the affine decomposition is stored.</div><div class="ttdef"><b>Definition</b> <a href="20incrementalPOD_8C_source.html#l00158">20incrementalPOD.C:158</a></div></div>
<div class="ttc" id="aextract__time__evolution_8C_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="extract__time__evolution_8C.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition</b> <a href="extract__time__evolution_8C_source.html#l00021">extract_time_evolution.C:21</a></div></div>
<div class="ttc" id="aincrementalPOD_8H_html"><div class="ttname"><a href="incrementalPOD_8H.html">incrementalPOD.H</a></div><div class="ttdoc">Header file of the incrementalPOD class.</div></div>
<div class="ttc" id="alaplacianProblem_8H_html"><div class="ttname"><a href="laplacianProblem_8H.html">laplacianProblem.H</a></div><div class="ttdoc">Header file of the laplacianProblem class.</div></div>
<div class="ttc" id="anamespaceITHACAstream_html_a36ae0d53d94f890fdfe72086003eacee"><div class="ttname"><a href="namespaceITHACAstream.html#a36ae0d53d94f890fdfe72086003eacee">ITHACAstream::exportSolution</a></div><div class="ttdeci">void exportSolution(GeometricField&lt; Type, PatchField, GeoMesh &gt; &amp;s, fileName subfolder, fileName folder, word fieldName)</div><div class="ttdoc">Export a field to file in a certain folder and subfolder.</div><div class="ttdef"><b>Definition</b> <a href="ITHACAstream_8C_source.html#l00904">ITHACAstream.C:904</a></div></div>
<div class="ttc" id="anamespaceITHACAutilities_html_a3f31e4b1e850395a67013e9e48f96a27"><div class="ttname"><a href="namespaceITHACAutilities.html#a3f31e4b1e850395a67013e9e48f96a27">ITHACAutilities::L2Norm</a></div><div class="ttdeci">double L2Norm(GeometricField&lt; scalar, fvPatchField, volMesh &gt; &amp;field)</div><div class="ttdef"><b>Definition</b> <a href="ITHACAerror_8C_source.html#l00041">ITHACAerror.C:41</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.13.2
</small></address>
</body>
</html>
